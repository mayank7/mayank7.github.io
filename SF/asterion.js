function urldecode(a){return unescape(a.replace(/\+/g," "))}function flashMessage(a){var b=$j("#flash_message");b.length&&(b.html(a),b.fadeIn("slow",function(){setTimeout(function(){b.fadeOut("slow")},3e3)}))}function padLeft(a,b,c){a=String(a),c=String(c);var d=b-a.length;for(i=0;d>i;i++)a=c+a;return a}function padRight(a,b,c){a=String(a),c=String(c);var d=b-a.length;for(i=0;d>i;i++)a+=c;return a}function sleep(a){for(a+=(new Date).getTime();new Date<a;);}function get_id(a,b){return $j(a).attr("id").replace(b+"_","")}function getId(a){var b,c=$j(a).attr("id");return(b=c.match(/_(\d+)$/))?parseInt(b[1]):null}function show_loading_indicator(a){$j("#"+a).addClass("loading_indicator")}function remove_loading_indicator(){$j(".loading_indicator").removeClass("loading_indicator")}function button_change(a){var b=$j(a).is(":checked"),c=$j(a).attr("name");elements=$j("#label_"+c+", #div_"+c),b?elements.addClass("asterion_button_change_on"):elements.removeClass("asterion_button_change_on")}function submit_dialog_form(a){var b=$j(a).parents().andSelf().filter("form")[0];return b?($j(b).submit(),!1):void 0}function dialog_form_disable(a){$j(a).addClass("disabled").find(".asterion_dialog_submit .dialog_button").addClass("button_disabled")}function dialog_form_enable(a){$j(a).removeClass("disabled").find(".asterion_dialog_submit .dialog_button").removeClass("button_disabled")}function fadeSlideShow(a){this.setting=a,a=null;var b=this.setting;b.fadeduration=b.fadeduration?parseInt(b.fadeduration,10):500,b.curimage=b.persist?fadeSlideShow.routines.getCookie("gallery-"+b.wrapperid):0,b.curimage=b.curimage||0,b.currentstep=0,b.totalsteps=b.imagearray.length*(b.displaymode.cycles>0?b.displaymode.cycles:1/0),b.fglayer=0,b.bglayer=1,b.oninit=b.oninit||function(){},b.onslide=b.onslide||function(){},b.displaymode.randomize&&b.imagearray.sort(function(){return.5-Math.random()});var c=[];b.longestdesc="";for(var d=0;d<b.imagearray.length;d++)c[d]=new Image,c[d].src=b.imagearray[d][0],b.imagearray[d][3]&&b.imagearray[d][3].length>b.longestdesc.length&&(b.longestdesc=b.imagearray[d][3]);var e=fadeSlideShow_descpanel.controls[0];b.closebutton="always"==b.descreveal?'<img class="close" src="'+e[0]+'" style="float:right;cursor:hand;cursor:pointer;width:'+e[1]+"px;height:"+e[2]+'px;margin-left:2px" title="Hide Description" />':"";var f=this;jQuery(document).ready(function(a){var b=f.setting,c=fadeSlideShow.routines.getFullHTML(b.imagearray);if(b.$wrapperdiv=a("#"+b.wrapperid).css({position:"relative",visibility:"visible",background:"black",overflow:"hidden",width:b.dimensions[0],height:b.dimensions[1]}).empty(),0===b.$wrapperdiv.length)return void alert('Error: DIV with ID "'+b.wrapperid+'" not found on page.');b.$gallerylayers=a('<div class="gallerylayer"></div><div class="gallerylayer"></div>').css({position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"black"}).appendTo(b.$wrapperdiv);var d=a('<img src="'+fadeSlideShow_descpanel.controls[2][0]+'" style="position:absolute;width:'+fadeSlideShow_descpanel.controls[2][1]+";height:"+fadeSlideShow_descpanel.controls[2][2]+'" />').css({left:b.dimensions[0]/2-fadeSlideShow_descpanel.controls[2][1]/2,top:b.dimensions[1]/2-fadeSlideShow_descpanel.controls[2][2]}).appendTo(b.$wrapperdiv),e=b.$gallerylayers.html(c).find("img").hide().eq(b.curimage);""!==b.longestdesc&&(fadeSlideShow.routines.adddescpanel(a,b),"always"==b.descreveal?(b.$descpanel.css({top:b.dimensions[1]-b.panelheight}),b.$descinner.click(function(a){"close"==a.target.className&&f.showhidedescpanel("hide")}),b.$restorebutton.click(function(){f.showhidedescpanel("show"),a(this).css({visibility:"hidden"})})):(b.$wrapperdiv.bind("mouseenter",function(){f.showhidedescpanel("show")}),b.$wrapperdiv.bind("mouseleave",function(){f.showhidedescpanel("hide")}))),b.$wrapperdiv.bind("mouseenter",function(){b.ismouseover=!0}),b.$wrapperdiv.bind("mouseleave",function(){b.ismouseover=!1}),e.get(0).complete?(d.hide(),f.paginateinit(a),f.showslide(b.curimage)):(d.hide(),f.paginateinit(a),e.bind("load",function(){f.showslide(b.curimage)})),b.oninit.call(f),a(window).bind("unload",function(){f.setting.persist&&fadeSlideShow.routines.setCookie("gallery-"+b.wrapperid,b.curimage),jQuery.each(f.setting,function(a){if(f.setting[a]instanceof Array)for(var b=0;b<f.setting[a].length;b++)"DIV"==f.setting[a][b].tagName&&(f.setting[a][b].innerHTML=null),f.setting[a][b]=null}),f=f.setting=null})})}var swfobject=function(){function a(){"complete"==u.readyState&&(u.parentNode.removeChild(u),b())}function b(){if(!L){if(N.ie&&N.win){var a=o("span");try{var b=C.getElementsByTagName("body")[0].appendChild(a);b.parentNode.removeChild(b)}catch(c){return}}L=!0,I&&(clearInterval(I),I=null);for(var d=E.length,e=0;d>e;e++)E[e]()}}function c(a){L?a():E[E.length]=a}function d(a){if(typeof B.addEventListener!=v)B.addEventListener("load",a,!1);else if(typeof C.addEventListener!=v)C.addEventListener("load",a,!1);else if(typeof B.attachEvent!=v)p(B,"onload",a);else if("function"==typeof B.onload){var b=B.onload;B.onload=function(){b(),a()}}else B.onload=a}function e(){for(var a=F.length,b=0;a>b;b++){var c=F[b].id;if(N.pv[0]>0){var d=n(c);d&&(F[b].width=d.getAttribute("width")?d.getAttribute("width"):"0",F[b].height=d.getAttribute("height")?d.getAttribute("height"):"0",q(F[b].swfVersion)?(N.webkit&&N.webkit<312&&f(d),s(c,!0)):F[b].expressInstall&&!M&&q("6.0.65")&&(N.win||N.mac)?g(F[b]):h(d))}else s(c,!0)}}function f(a){var b=a.getElementsByTagName(w)[0];if(b){var c=o("embed"),d=b.attributes;if(d)for(var e=d.length,f=0;e>f;f++)"DATA"==d[f].nodeName?c.setAttribute("src",d[f].nodeValue):c.setAttribute(d[f].nodeName,d[f].nodeValue);var g=b.childNodes;if(g)for(var h=g.length,i=0;h>i;i++)1==g[i].nodeType&&"PARAM"==g[i].nodeName&&c.setAttribute(g[i].getAttribute("name"),g[i].getAttribute("value"));a.parentNode.replaceChild(c,a)}}function g(a){M=!0;var b=n(a.id);if(b){if(a.altContentId){var c=n(a.altContentId);c&&(J=c,K=a.altContentId)}else J=i(b);!/%$/.test(a.width)&&parseInt(a.width,10)<310&&(a.width="310"),!/%$/.test(a.height)&&parseInt(a.height,10)<137&&(a.height="137"),C.title=C.title.slice(0,47)+" - Flash Player Installation";var d=N.ie&&N.win?"ActiveX":"PlugIn",e=C.title,f="MMredirectURL="+B.location+"&MMplayerType="+d+"&MMdoctitle="+e,g=a.id;if(N.ie&&N.win&&4!=b.readyState){var h=o("div");g+="SWFObjectNew",h.setAttribute("id",g),b.parentNode.insertBefore(h,b),b.style.display="none";var k=function(){b.parentNode.removeChild(b)};p(B,"onload",k)}j({data:a.expressInstall,id:A,width:a.width,height:a.height},{flashvars:f},g)}}function h(a){if(N.ie&&N.win&&4!=a.readyState){var b=o("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(i(a),b),a.style.display="none";var c=function(){a.parentNode.removeChild(a)};p(B,"onload",c)}else a.parentNode.replaceChild(i(a),a)}function i(a){var b=o("div");if(N.win&&N.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(w)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function j(a,b,c){var d,e=n(c);if(e)if(typeof a.id==v&&(a.id=c),N.ie&&N.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",G[G.length]=a.id,d=n(a.id)}else if(N.webkit&&N.webkit<312){var j=o("embed");j.setAttribute("type",z);for(var l in a)a[l]!=Object.prototype[l]&&("data"==l.toLowerCase()?j.setAttribute("src",a[l]):"styleclass"==l.toLowerCase()?j.setAttribute("class",a[l]):"classid"!=l.toLowerCase()&&j.setAttribute(l,a[l]));for(var m in b)b[m]!=Object.prototype[m]&&"movie"!=m.toLowerCase()&&j.setAttribute(m,b[m]);e.parentNode.replaceChild(j,e),d=j}else{var p=o(w);p.setAttribute("type",z);for(var q in a)a[q]!=Object.prototype[q]&&("styleclass"==q.toLowerCase()?p.setAttribute("class",a[q]):"classid"!=q.toLowerCase()&&p.setAttribute(q,a[q]));for(var r in b)b[r]!=Object.prototype[r]&&"movie"!=r.toLowerCase()&&k(p,r,b[r]);e.parentNode.replaceChild(p,e),d=p}return d}function k(a,b,c){var d=o("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function l(a){var b=n(a);!b||"OBJECT"!=b.nodeName&&"EMBED"!=b.nodeName||(N.ie&&N.win?4==b.readyState?m(a):B.attachEvent("onload",function(){m(a)}):b.parentNode.removeChild(b))}function m(a){var b=n(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function n(a){var b=null;try{b=C.getElementById(a)}catch(c){}return b}function o(a){return C.createElement(a)}function p(a,b,c){a.attachEvent(b,c),H[H.length]=[a,b,c]}function q(a){var b=N.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function r(a,b){if(!N.ie||!N.mac){var c=C.getElementsByTagName("head")[0],d=o("style");if(d.setAttribute("type","text/css"),d.setAttribute("media","screen"),N.ie&&N.win||typeof C.createTextNode==v||d.appendChild(C.createTextNode(a+" {"+b+"}")),c.appendChild(d),N.ie&&N.win&&typeof C.styleSheets!=v&&C.styleSheets.length>0){var e=C.styleSheets[C.styleSheets.length-1];typeof e.addRule==w&&e.addRule(a,b)}}}function s(a,b){var c=b?"visible":"hidden";L&&n(a)?n(a).style.visibility=c:r("#"+a,"visibility:"+c)}function t(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c?encodeURIComponent(a):a}{var u,v="undefined",w="object",x="Shockwave Flash",y="ShockwaveFlash.ShockwaveFlash",z="application/x-shockwave-flash",A="SWFObjectExprInst",B=window,C=document,D=navigator,E=[],F=[],G=[],H=[],I=null,J=null,K=null,L=!1,M=!1,N=function(){var a=typeof C.getElementById!=v&&typeof C.getElementsByTagName!=v&&typeof C.createElement!=v,b=[0,0,0],c=null;if(typeof D.plugins!=v&&typeof D.plugins[x]==w)c=D.plugins[x].description,!c||typeof D.mimeTypes!=v&&D.mimeTypes[z]&&!D.mimeTypes[z].enabledPlugin||(c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),b[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),b[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),b[2]=/r/.test(c)?parseInt(c.replace(/^.*r(.*)$/,"$1"),10):0);else if(typeof B.ActiveXObject!=v){var d=null,e=!1;try{d=new ActiveXObject(y+".7")}catch(f){try{d=new ActiveXObject(y+".6"),b=[6,0,21],d.AllowScriptAccess="always"}catch(f){6==b[0]&&(e=!0)}if(!e)try{d=new ActiveXObject(y)}catch(f){}}if(!e&&d)try{c=d.GetVariable("$version"),c&&(c=c.split(" ")[1].split(","),b=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)])}catch(f){}}var g=D.userAgent.toLowerCase(),h=D.platform.toLowerCase(),i=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,j=!1,k=/win/.test(h?h:g),l=/mac/.test(h?h:g);return{w3cdom:a,pv:b,webkit:i,ie:j,win:k,mac:l}}();!function(){if(N.w3cdom){if(c(e),N.ie&&N.win)try{C.write("<script id=__ie_ondomload defer=true src=//:></script>"),u=n("__ie_ondomload"),u&&p(u,"onreadystatechange",a)}catch(f){}N.webkit&&typeof C.readyState!=v&&(I=setInterval(function(){/loaded|complete/.test(C.readyState)&&b()},10)),typeof C.addEventListener!=v&&C.addEventListener("DOMContentLoaded",b,null),d(b)}}(),function(){N.ie&&N.win&&window.attachEvent("onunload",function(){for(var a=H.length,b=0;a>b;b++)H[b][0].detachEvent(H[b][1],H[b][2]);for(var c=G.length,d=0;c>d;d++)l(G[d]);for(var e in N)N[e]=null;N=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}()}return{registerObject:function(a,b,c){if(N.w3cdom&&a&&b){var d={};d.id=a,d.swfVersion=b,d.expressInstall=c?c:!1,F[F.length]=d,s(a,!1)}},getObjectById:function(a){var b=null;if(N.w3cdom){var c=n(a);if(c){var d=c.getElementsByTagName(w)[0];!d||d&&typeof c.SetVariable!=v?b=c:typeof d.SetVariable!=v&&(b=d)}}return b},embedSWF:function(a,b,d,e,f,h,i,k,l){if(N.w3cdom&&a&&b&&d&&e&&f)if(d+="",e+="",q(f)){s(b,!1);var m={};if(l&&typeof l===w)for(var n in l)l[n]!=Object.prototype[n]&&(m[n]=l[n]);m.data=a,m.width=d,m.height=e;var o={};if(k&&typeof k===w)for(var p in k)k[p]!=Object.prototype[p]&&(o[p]=k[p]);if(i&&typeof i===w)for(var r in i)i[r]!=Object.prototype[r]&&(typeof o.flashvars!=v?o.flashvars+="&"+r+"="+i[r]:o.flashvars=r+"="+i[r]);c(function(){j(m,o,b),m.id==b&&s(b,!0)})}else h&&!M&&q("6.0.65")&&(N.win||N.mac)&&(M=!0,s(b,!1),c(function(){var a={};a.id=a.altContentId=b,a.width=d,a.height=e,a.expressInstall=h,g(a)}))},getFlashPlayerVersion:function(){return{major:N.pv[0],minor:N.pv[1],release:N.pv[2]}},hasFlashPlayerVersion:q,createSWF:function(a,b,c){return N.w3cdom?j(a,b,c):void 0},removeSWF:function(a){N.w3cdom&&l(a)},createCSS:function(a,b){N.w3cdom&&r(a,b)},addDomLoadEvent:c,addLoadEvent:d,getQueryParamValue:function(a){var b=C.location.search||C.location.hash;if(null==a)return t(b);if(b)for(var c=b.substring(1).split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return t(c[d].substring(c[d].indexOf("=")+1));return""},expressInstallCallback:function(){if(M&&J){var a=n(A);a&&(a.parentNode.replaceChild(J,a),K&&(s(K,!0),N.ie&&N.win&&(J.style.display="block")),J=null,K=null,M=!1)}}}}();$j=jQuery.noConflict(),function(a){Number.prototype.bytes=function(){return this},Number.prototype.kilobytes=function(){return 1024*this},Number.prototype.megabytes=function(){return this*1024..kilobytes()},Number.prototype.gigabytes=function(){return this*1024..megabytes()},Number.prototype.terabytes=function(){return this*1024..gigabytes()},Number.prototype.petabytes=function(){return this*1024..terabytes()},Number.prototype.exabytes=function(){return this*1024..petabytes()},a.each(["byte","kilobyte","megabyte","gigabyte","terabyte","petabyte","exabyte"],function(){Number.prototype[this]=Number.prototype[this+"s"]}),Number.prototype.toPercentage=function(a){return a=parseInt(a)||1,(100*this).toFixed(a)+"%"},Number.prototype.toHumanSize=function(a){return a=parseInt(a)||1,this<1..kilobyte()?this+" Bytes":this<1..megabyte()?(this/1..kilobyte()).toFixed(a)+" KB":this<1..gigabytes()?(this/1..megabyte()).toFixed(a)+" MB":this<1..terabytes()?(this/1..gigabytes()).toFixed(a)+" GB":this<1..petabytes()?(this/1..terabytes()).toFixed(a)+" TB":this<1..exabytes()?(this/1..petabytes()).toFixed(a)+" PB":(this/1..exabytes()).toFixed(a)+" EB"},a.asterion=a.asterion||{},a.asterion.required=[],a.createCallbacks=function(b,c){c=a.makeArray(c),a.each(c,function(){var c=this;b._callbacks=b._callbacks||{},b._callbacks[c]=[],b[c]=function(){if("function"==typeof arguments[0]&&1==arguments.length){var b=arguments[0];return this._callbacks[c][this._callbacks[c].length]=b,this}for(var d,e=0;e<this._callbacks[c].length;e++)if(d=this._callbacks[c][e].apply(this,a.makeArray(arguments)),d===!1)return!1;return!0}})},a.asterion.clearIframes=function(b,c,d){d=d||this;var e=a("iframe",b);e.length&&navigator&&"Microsoft Internet Explorer"==navigator.appName?(e.each(function(){var b=a(this);b.attr("data-src",b.attr("src")).attr("src","")}),setTimeout(function(){c.call(d)},100)):c.call(d)},a.asterion.restoreIframes=function(b){navigator&&"Microsoft Internet Explorer"==navigator.appName&&a("iframe",b).each(function(){var b=a(this);""==b.attr("src")&&b.attr("src",b.attr("data-src"))})},a.asterion.humanize=function(a){return a.replace("_"," ").replace(/\w+/g,function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()})},a.asterion.confirm_dialog=function(b,c,d){a.asterion.dialog.confirm(c,{buttons:d,title:b})},a.asterion.rjs=function(b,c){a.ajax({url:b,dataType:"script",data:c,type:"POST",beforeSend:function(a){a.setRequestHeader("Accept","text/javascript")}})},a.asterion.confirm_delete=function(b){var c=b.link_target,d=b.title,e=b.msg_target,f=b.button1_txt||I18n.t("js.delete"),g=b.button2_txt||I18n.t("js.cancel");a(c).click(function(){var b=a(this).attr("href"),c=d,h=a(e).html(),i=[{text:f,click:function(){a.asterion.rjs(b,{confirm:!0}),a(this).dialog("close")}},{text:g,click:function(){a(this).dialog("close")}}];return a.asterion.confirm_dialog(c,h,i),!1})},a.asterion.alert=function(b,c,d){var e=[{text:"OK",click:function(){a(this).dialog("close"),d&&a.isFunction(d)&&d()}}];a.asterion.confirm_dialog(b,c,e)},a.asterion.checkGuestbooks=function(){a(".guestbook_component").length>0?a.asterion.alert(I18n.t("js.guestbook_component"),I18n.t("js.only_one_guestbook")):(a.asterion.componentIndicators.enable(),a.asterion.dialog.close())},a.asterion.offer_blog=function(){var b=I18n.t("js.no_blog_component"),c="<p>"+I18n.t("js.no_blog_component_msg").replace("\n","</p><p>")+"</p>",d=[{text:I18n.t("js.yes_add_blog"),click:function(){var b="/resource/component/add";a.asterion.rjs(b,{confirm:!0}),a(this).dialog("close")}},{text:I18n.t("js.no_add_blog"),click:function(){var b="/resource/blog/post/manage";a.asterion.dialog.open(b,{}),a(this).dialog("close")}}];a.asterion.confirm_dialog(b,c,d)},a.asterion.title_link=function(b,c){a("#component_title_link").val(b),a("#component_title_target").val(c),a.asterion.dialog.close(),a(document).trigger("title_link_change",[b,c])},a(document).on("click","a.delete_component",function(b){var c=a(this).attr("href"),d=I18n.t("js.remove_component"),e=[{text:I18n.t("js.remove_component"),click:function(){a.asterion.rjs(c,{confirm:!0}),a(this).dialog("close")}},{text:I18n.t("js.cancel"),click:function(){a(this).dialog("close")}}],f=!1;return a(a(this).parents()).each(function(b,c){return a(c).hasClass("asterion_readonly_component_editor")?f=!0:void 0}),f?(a.asterion.alert(I18n.t("js.readonly_component"),I18n.t("js.cannot_delete_component")),b.preventDefault(),!1):(a.spinner().show(),a.get(c,function(b){a.spinner().hide(),a.asterion.confirm_dialog(d,b,e)}),void b.preventDefault())}),a(document).on("click","a.copy_component",function(b){var c=a(this),d=c.attr("href"),e=I18n.t("js.copy_component"),f=[{text:I18n.t("js.copy_component"),click:function(){var b=a(this).closest(".ui-dialog").find("select").val(),d=c.attr("href").split("/").pop(),e=b==window.location.pathname,f={id:d,uri:b,insertAfterId:e?d:void 0};a.asterion.component.copy(f,function(c){e?(a("#component_"+d).after(c),a.asterion.behaviors.addLocationHelperClasses(),a(document).trigger("component.setup")):window.location=b}),a(this).dialog("close")}},{text:I18n.t("js.cancel"),click:function(){a(this).dialog("close")}}],g=!1;return a(a(this).parents()).each(function(b,c){return a(c).hasClass("asterion_readonly_component_editor")?g=!0:void 0}),g?(a.asterion.alert(I18n.t("js.readonly_component"),I18n.t("js.cannot_copy_component")),b.preventDefault(),!1):(a.spinner().show(),a.get(d,function(b){a.spinner().hide(),a.asterion.confirm_dialog(e,b,f)}),void b.preventDefault())}),a(document).on("click","a.restore_theme_image",function(b){var c=a(this).attr("href"),d=I18n.t("js.restore_theme_image"),e="<p>"+I18n.t("js.restore_theme_image_msg")+"</p>",f=[{text:I18n.t("js.use_default_image"),click:function(){a.spinner().show(),a.asterion.rjs(c,{confirm:!0}),a(this).dialog("close")}},{text:I18n.t("js.cancel"),click:function(){a(this).dialog("close")}}];a.asterion.confirm_dialog(d,e,f),b.preventDefault()}),a(document).on("click","a.confirm_delete_page",function(b){var c=a(this).attr("href"),d=I18n.t("js.delete_page"),e="<p>"+I18n.t("js.delete_page_msg").replace("\n","</p><p>")+"</p>",f=[{text:I18n.t("js.delete_page"),click:function(){a.asterion.rjs(c,{confirm:!0}),a(this).dialog("close")}},{text:I18n.t("js.cancel"),click:function(){a(this).dialog("close")}}];a.asterion.confirm_dialog(d,e,f),b.preventDefault()}),a(document).on("click","#component_editor_container .delete_comment",function(b){var c=a(this).attr("href"),d=I18n.t("js.delete_message"),e="<p>"+I18n.t("js.delete_message_msg").replace("\n","</p><p>")+"</p>",f=[{text:I18n.t("js.delete_message"),click:function(){a.asterion.rjs(c,{confirm:!0}),a(this).dialog("close")}},{text:I18n.t("js.cancel"),click:function(){a(this).dialog("close")}}];a.asterion.confirm_dialog(d,e,f),b.preventDefault()}),a.asterion.switchContentEditor=function(a,b){"visual"===a?($j("#"+b).tinymce().show(),$j("#tiny_templates").show(),$j("#html_editor_link").removeClass("active"),$j("#visual_editor_link").addClass("active")):($j("#"+b).tinymce().hide(),$j("#tiny_templates").hide(),$j("#visual_editor_link").removeClass("active"),$j("#html_editor_link").addClass("active"),$j("#"+b).addClass("html_editor"),$j("#"+b).css({visibility:"visible",width:"762px"}))},a.asterion.showTooltip=function(b,c,d){a('<div id="asterion_tooltip">'+b+"</div>").css({top:d+5,left:c+5}).appendTo("body").fadeIn(200)},a.asterion.hideTooltip=function(){$j("#asterion_tooltip").remove()},a.asterion.parseBackgroundPosition=function(a){if("string"!=typeof a||0===a.length)return[0,"px",0,"px"];a=a.replace(/left|top/g,"0px"),a=a.replace(/right|bottom/g,"100%"),a=a.replace(/center/g,"50%"),a=a.replace(/(\d+)(\s|\)|$)/g,"$1px$2");var b=a.match(/(\d+)(px|\%|em|pt)\s(\d+)(px|\%|em|pt)/);return b||(b=[0,0,0,0]),[parseFloat(b[1]||0),b[2]||0,parseFloat(b[3]||0),b[4]||0]},a.asterion.showLinkedAccounts=function(b){a("#select_"+b+"_account ul.account_selector").show()},a.asterion.changeLinkedAccount=function(b,c){a("#announce_"+b).val(c),a("#select_"+b+"_account label a").text(a("#"+b+"_account_"+c+" a").text()),a("#select_"+b+"_account ul.account_selector").hide()},a.asterion.flickrSelect=function(b){var c=arguments[1]||{},d="";return c.username&&(d="?search_filter="+c.username),this.dialog.open("/resource/flickr/browse"+d,{name:"flickr_browse",close:function(){arguments[0]&&arguments[1]&&b.apply(this,a.makeArray(arguments))}})},a.asterion.youtubeSelect=function(b){return a.asterion.dialog.open("/resource/youtube/search",{name:"youtube_browse",close:function(){arguments[0]&&b.apply(this,a.makeArray(arguments))}})},a.asterion.assetSelect=function(b){var c,d=arguments[1]||{},e=[];d.type=d.type||"all",d.selection_type=d.selection_type||"all";var f=function(){arguments[0]&&arguments[1]?b.apply(this,a.makeArray(arguments)):a.asterion.dialog.closeAll()};return d.upload?(c="all"==d.type?"/resource/select/all/upload":"/resource/select;"+d.type+"/upload",""!==d.collection&&"undefined"!=typeof d.collection&&(c+="/collection/"+d.collection),c+="?direct_upload=true&active_tab=upload_files",""!==d.selection_type&&"undefined"!=typeof d.selection_type&&(c+="&selection_type="+d.selection_type),""!==d.content_type&&"undefined"!=typeof d.content_type&&(c+="&content_type="+d.content_type),""!==d.file_types&&"undefined"!=typeof d.file_types&&(c+="&file_types="+d.file_types),""!==d.file_types_description&&"undefined"!=typeof d.file_types_description&&(c+="&file_types_description="+d.file_types_description),""!==d.component&&"undefined"!=typeof d.component&&(c+="&component="+d.component),a.asterion.dialog.open(c,{name:"asset_manager_browse",complete:function(){swfupload_manager.completion_callback=function(){if(d.closeOnUpload)return b.apply(this),a.asterion.dialog.close(),!1;var c=$j(".successful_upload");return 1!=c.length||"all"!=d.type&&d.type!=c.data("file_data").type.toLowerCase()?void 0:(a.ajax({url:"/resource/asset/select",type:"POST",dataType:"script",data:{asset_id:c.data("file_data").id,asset_url:c.data("file_data").url},success:function(){}}),!1)}},close:f})):d.library?(c="/resource/image_library?lock_type=true&selector=true&type=all&active_tab=stock_photos",""!==d.selection_type&&"undefined"!=typeof d.selection_type&&(c+="&selection_type="+d.selection_type),a.asterion.dialog.open(c,{name:"asset_manager_browse",close:f})):(c="all"==d.type?"/resource/select":"/resource/select;"+d.type,""!=d.url&&"undefined"!=typeof d.url&&(c+=d.url),""!==d.content_type&&"undefined"!=typeof d.content_type&&e.push("content_type="+d.content_type),""!==d.selection_type&&"undefined"!=typeof d.selection_type&&e.push("&selection_type="+d.selection_type),""!==d.file_types&&"undefined"!=typeof d.file_types&&e.push("&file_types="+d.file_types),""!==d.file_types_description&&"undefined"!=typeof d.file_types_description&&e.push("&file_types_description="+d.file_types_description),e.length&&(c+="?active_tab=browse_files&"+e.join("&")),a.asterion.dialog.open(c,{name:"asset_manager_browse",close:f}))},a.asterion.makePermalink=function(a){return a.toLowerCase().replace(/[&#'"\(\)\:%\$\?\+;,?\/\s.]/g,"-").replace(/--+/g,"-")},a.bind_function=function(b,c){return function(){return b.apply(c,a.makeArray(arguments))}},a.asterion.relativeDate=function(a){var b=new Date(parseInt(a,10)),c=((new Date).getTime()-b.getTime())/1e3,d=Math.floor(c/86400);return isNaN(d)||0>d||d>=365?"":0===d&&(60>c&&I18n.t("js.time.just_now")||120>c&&I18n.t("js.time.one_minute_ago")||3600>c&&I18n.t("js.time.n_minutes_ago",{n:Math.floor(c/60)})||7200>c&&I18n.t("js.time.one_hour_ago")||86400>c&&I18n.t("js.time.n_hours_ago",{n:Math.floor(c/3600)}))||1==d&&I18n.t("js.time.yesterday")||7>d&&I18n.t("js.time.n_days_ago",{n:d})||31>d&&I18n.t("js.time.n_weeks_ago",{n:Math.ceil(d/7)})||360>d&&I18n.t("js.time.n_months_ago",{n:Math.ceil(d/30)})||I18n.t("js.time.n_years_ago",{n:Math.ceil(d/365)})},a.fn.relativeDate=function(){return this.each(function(){var b=a.asterion.relativeDate(this.title);b&&a(this).text(b)})},a.fn.replaceWith=function(a){return this.before(a).remove()},a.fn.disableSelection=function(){return this.each(function(){this.unselectable="on",this.onselectstart=function(){return!1},this.style&&(this.style.MozUserSelect="none")})},a.fn.reverse=[].reverse,a.fn.contains_coordinates=function(b,c,d){d=d||0;var e=!1;return this.each(function(){var f=a(this).offset();f.right=f.left+a(this).get(0).offsetWidth,f.bottom=f.top+a(this).get(0).offsetHeight;var g=Math.max(f.left-b,b-f.right,0)+Math.max(f.top-c,c-f.bottom,0);return d>=g?(e=a(this),!1):void 0}),e},a.fn.overlap=function(b,c){var d=a(this).contains_coordinates(b,c);if(!d)return!1;var e=d.get(0).offsetHeight,f=c-d.offset().top;return f/e},a.fn.observe=function(b,c){return this.each(function(){var d,e,f=this,g=a(f).serialize();d=setInterval(function(){if(!$j(f).parents("body")[0])return void clearInterval(d);var b;b=a(f).serialize(),g!=b&&(b==e?(e="",g=b,c.call(f)):e=b)},1e3*b)})},a.fn.fadeOutAndRemove=function(b,c){var d=a(this);if(d.length){a.isFunction(b)&&(c=b,b=null),b=b?b:400;var e=a(d[d.length-1]).addClass("lastItem"),f=d.not(".lastItem");f.fadeOut(b,function(){f.remove()}),e.fadeOut(b,function(){a(this).remove(),a.isFunction(c)&&c()})}},a.fn.autosave=function(b){var c={delay:6e4,create:function(){},change:function(){},start:function(){},complete:function(){}};a.extend(c,b);var d=this,e=!0;d.one("oninit",function(a,b){d.data("editor",b).trigger("waitforchanges"),c.create.call(d)}),d.on("waitforchanges",function(){d.data("editor").onKeyDown.add(f)}),d.on("enable",function(a,b){e=b,e&&(d.trigger("waitforchanges"),f(d.data("editor")))}),d.on("save",function(){var b=d.closest("form");if(b.length)return c.start.call(d),0==d.html().replace(/\s+/,"").length?void d.trigger("waitforchanges"):void a.ajax({url:b.attr("action"),data:b.serialize(),dataType:"json",type:"post",error:function(){d.trigger("waitforchanges")},success:function(e,f){c.complete.call(d,e,f),a.isFunction(b[0].saved)&&b[0].saved(),a.asterion.dialog.reloadPageOnClose(),a.asterion.dialog.reloadParentOnClose(),d.trigger("waitforchanges")}})});var f=function(b){a.asterion.dialog.hasUnsavedChanges()&&(c.change.call(d),b.onKeyDown.remove(f),setTimeout(g,c.delay))},g=function(){e&&d.trigger("save")}},a.fn.ajaxScroll=function(b){function c(c){c=c||!1,f=!0,a.spinner().show(),a.ajax(a.extend({},b,{data:a.extend({page:a.asterion._ajax_page_counter},b.data),error:function(c){a.spinner().hide(),b.error(c.responseText)},success:function(e){a.asterion._ajax_page_counter++,a.spinner().hide(),b.success(e,c);var g=d.height();g==h||(h=g),f=!1}}))}var d=a(this),e={data:{},start:1,error:function(){return!1},success:function(){return!0}};b=a.extend(e,b);var f=!1,g=null,h=d.height();a.asterion._ajax_page_counter=b.start,a(this).unbind("scroll"),a(this).unbind("refresh"),d.scroll(function(){g=a(".ajax_scroll_inner_wrap",this),0==g.length&&(a(this).wrapInner('<div class="ajax_scroll_inner_wrap"></div>'),g=a(".ajax_scroll_inner_wrap",this)),this.offsetHeight+this.scrollTop>=this.scrollHeight&&!f&&c()}),d.bind("refresh",function(){a.asterion._ajax_page_counter=1,c(!0)})},a.extend(a.fx.step,{backgroundPosition:function(b){if(0===b.state&&"string"==typeof b.end){var c=a.curCSS(b.elem,"backgroundPosition");c=a.asterion.parseBackgroundPosition(c),b.start=[c[0],c[2]];var d=a.asterion.parseBackgroundPosition(b.end);b.end=[d[0],d[2]],b.unit=[d[1],d[3]]}var e=[];e[0]=(b.end[0]-b.start[0])*b.pos+b.start[0]+b.unit[0],e[1]=(b.end[1]-b.start[1])*b.pos+b.start[1]+b.unit[1],b.elem.style.backgroundPosition=e[0]+" "+e[1]}}),a.ajaxSetup({converters:{"text asterionjavascript":function(a){return a}}}),a.ui&&(a.ui.draggable.prototype.reset_position=function(b){var c=this.options;b&&(c.cursorAt=a.extend(c.cursorAt,b)),this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()},c.cursorAt&&(void 0!=c.cursorAt.left&&(this.offset.click.left=c.cursorAt.left+this.margins.left),void 0!=c.cursorAt.right&&(this.offset.click.left=this.helperProportions.width-c.cursorAt.right+this.margins.left),void 0!=c.cursorAt.top&&(this.offset.click.top=c.cursorAt.top+this.margins.top),void 0!=c.cursorAt.bottom&&(this.offset.click.top=this.helperProportions.height-c.cursorAt.bottom+this.margins.top))},a.ui.sortable.prototype._originalIntersectsWithEdge=a.ui.sortable.prototype._intersectsWithEdge,a.ui.sortable.prototype._intersectsWithEdge=function(a){if("static"==this.options.tolerance){var b=this.positionAbs.left,c=(b+this.helperProportions.width,this.positionAbs.top),d=(c+this.helperProportions.height,a.left),e=d+a.width,f=a.top,g=f+a.height,h=this.offset.click.top,i=this.offset.click.left,j=c+h>f&&g>c+h&&b+i>d&&e>b+i;return j?this.floating?(d+e)/2>i+b?1:2:(f+g)/2>h+c?1:2:!1}return this._originalIntersectsWithEdge(a)}),a(function(a){if(a(".asterion_toolbar_inner_wrapper").get(0)){a("#asterion_my_website, #asterion_my_content, #asterion_page_actions, #asterion_page_select, #asterion_layouts, #asterion_edit_theme, #locale_selector").hover(function(b,c){(!a.asterion.componentEditor.draggingEditor||c)&&a(this).find("ul.asterion_toolbar_dropdown_menu").fadeIn("fast")},function(b,c){(!a.asterion.componentEditor.draggingEditor||c)&&a(this).find("ul.asterion_toolbar_dropdown_menu").hide()}),bg_position=a.browser.msie&&document.documentMode>=9?a("body").css("background-position-x")+" "+a("body").css("background-position-y"):a("body").css("background-position"),orig_mobile_bar_position=a("#asterion_page_wrapper #mobile_wrapper").css("top");var b=a.asterion.parseBackgroundPosition(bg_position);if(0===b[2]||"px"===b[3]){var c={original:b[0]+b[1]+" "+b[2]+"px",lowered:b[0]+b[1]+" "+(b[2]+69)+"px"};a("body").css("background-position",c.lowered)}show_listener=function(){return show_action(),!1},show_action=function(){show_tab[0].timeout&&clearTimeout(show_tab[0].timeout),show_tab.animate({top:"-38px"},{complete:function(){a("#remove_branding_link,.feedback").show(),$j(this).remove(),a(".unpublished, .invisible").slideDown(),$j("#asterion_toolbar").slideDown(),a("#asterion_page_wrapper #mobile_wrapper").animate({top:orig_mobile_bar_position}),$j("#asterion_page_wrapper").animate({paddingTop:"69px",paddingBottom:"25px"}),c&&$j("body").animate({backgroundPosition:"("+c.lowered+")"}),document.cookie="toolbar_status=show; path=/"}})},hide_listener=function(){return hide_action({animate:!0}),!1},hide_action=function(b){return a.asterion.component.layoutMode===!0&&(a.asterion.component.toggleLayoutMode(),a("#asterion_layout_mode").removeClass("active_status_link")),show_tab=a('<div id="show_tab" class="asterion_secondary_color asterion_secondary_bgcolor asterion_hover_color">          <div id="asterion_hide_explanation" class="asterion_secondary_color asterion_secondary_bgcolor">'+I18n.t("js.hidden_editor_msg")+'</div>          <a href="javascript:void(0)" id="asterion_show_link" class="toggle_tab">'+I18n.t("js.show_editor")+"</a>          </div>").prependTo(document.body),1==b.animate?show_tab[0].timeout=setTimeout(function(){$j("#asterion_hide_explanation").fadeOut()
},5e3):$j("#asterion_hide_explanation").hide(),a("#asterion_show_link").click(show_listener),1==b.animate?(a(".unpublished, .invisible").slideUp(),$j("#asterion_toolbar").slideUp(),$j("#asterion_page_wrapper").animate({paddingTop:0,paddingBottom:0},{complete:function(){show_tab.animate({top:"-2px"}),a("#remove_branding_link,.feedback").hide()}}),a("#asterion_page_wrapper #mobile_wrapper").animate({top:0})):(a(".unpublished, .invisible").hide(),$j("#asterion_toolbar").hide(),$j("#asterion_page_wrapper").css({paddingTop:0,paddingBottom:0}),show_tab.css({top:"-2px"}),a("#asterion_page_wrapper #mobile_wrapper").css({top:0})),c&&(1==b.animate?$j("body").animate({"background-position-y":c.original.split(" ")[1]}):$j("body").css({backgroundPosition:"("+c.original+")"})),document.cookie="toolbar_status=hide; path=/",!1},a("#asterion_hide_link").click(hide_listener),a("#asterion_layout_mode a").click(function(){a(this).text(I18n.t(a(this).text()==I18n.t("js.collapse_blocks")?"js.expand_blocks":"js.collapse_blocks")),a.asterion.component.toggleLayoutMode()}),-1!=document.cookie.indexOf("toolbar_status=hide")&&hide_action({animate:!1}),a("#asterion_toolbar").disableSelection()}}),a.fn.confirmAction=function(b){var c={title:I18n.t("js.default_confirm_title"),message:I18n.t("js.default_confirm_msg"),action_button:I18n.t("js.default_confirm_action_button"),cancel_button:I18n.t("js.cancel"),click:function(){},error:function(){},success:function(){}};c=a.extend(c,b),a(document).on("click",this.selector,function(b){var d=a(this),e=d.attr("href"),f=function(){a.ajax({url:e+"?confirm=true",dataType:"json",type:"POST",statusCode:{200:function(a,b,e){c.success.call(d,a,b,e)}},error:function(a,b,d){c.error.call(a,b,d)}})};if(0==c.click.call(this,b,f))return!1;var g={title:a.isFunction(c.title)?c.title.call(d):c.title,buttons:[{text:a.isFunction(c.action_button)?c.action_button.call(d):c.action_button,click:function(){f(),a(this).dialog("close")}},{text:a.isFunction(c.cancel_button)?c.cancel_button.call(d):c.cancel_button,click:function(){a(this).dialog("close")}}]};return a.asterion.dialog.confirm(a.isFunction(c.message)?c.message.call(d):c.message,g),!1})},a.fn.preload=function(b){var c=a("img",this),d=c.length;0==c.length&&b(),c.each(function(){var a=new Image;a.src=this.src,a.onload=function(){d--,0>=d&&b()}})},a.fn.spinner=function(){var b=a("#spinner");return b.length||(b=a('<div id="spinner"></div>').hide()),b.parent().length||a(this).length||(a.asterion.dialog.visible()?a(".dialog_core",a.asterion.dialog.visibleDialog()).append(b):a("body").append(b)),a(this).length&&a(this).append(b),b.css(a("body > #spinner").length?{position:"fixed"}:{position:"absolute"}),b},a.fn.attention=function(){a(this).css({backgroundColor:"#FFEAE8"}).animate({backgroundColor:"#fff"},1e3,function(){a(this).css("backgroundColor","transparent")})},a.fn.serializeObject=function(){var b={},c=this.serializeArray();return a.each(c,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},a.extend({containerWidth:function(){var b=a("#"+a.cookie("editing_location")),c=parseInt(b.css("padding-right")),d=parseInt(b.css("padding-left")),e=b.width()-(c+d);return e},spinner:function(){return a().spinner()},browser:function(){var a=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",c[0];);return a>4?a:!1}();return{msie:a,version:a}}(),deparam:function(a){for(var b,a=a.substring(a.indexOf("?")+1),c={},d=a.split("&"),e=0,f=d.length;f>e;e++)b=d[e].split("="),c[b[0]]=b[1];return c},decodeEntities:function(){function b(a){return a&&"string"==typeof a&&(a=a.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),a=a.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),a=c.html(a).text(),c.html("")),a}var c=a("<div>");return b}()})}($j),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.permalink=function(){return this.replace(/\W+/g," ").trim().toLowerCase().replace(/\s+/g,"-")},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),function(a){a.asterion=a.asterion||{},a.asterion.behaviors={removeScripts:function(){setTimeout(function(){a(".component script").remove()},1)},attachToRelativeDates:function(){a(".relative_date").relativeDate().removeClass("relative_date")},attachToDialogHeaders:function(){},attachToGraphicalSelect:function(){a("ul.account_selector").bind("mouseleave",function(){a(this).hide()});var b=a(".graphical_select"),c=b.find("img"),d=b.find("span"),e=b.find("input[type='radio']"),f=a("input[type='radio']:checked").parent();f.find("img").css("border","3px solid #3f98d7"),f.find("span").css("color","#3f98d7"),e.css("display","none"),c.click(function(){var b=a(this).parent().parent();b.find("input").get(0).checked="checked",c.css("border","3px solid #bfbeb6"),d.css("color","#4F4B40"),a(this).css("border","3px solid #3f98d7"),b.find("span").css("color","#3f98d7")})},addLocationHelperClasses:function(){a(".location").each(function(){var b,c=a(this).find(".component").removeClass("first last even odd").filter(":first").addClass("first").end().filter(":even").addClass("even").end().filter(":odd").addClass("odd").end().filter(":last").addClass("last").end();for(i=0;i<c.length;i++)b=a(c[i]).attr("class").match(/(item_\d+)/),b&&a(c[i]).removeClass(b[0]),a(c[i]).addClass("item_"+i.toString())})},attachToRichTextEditors:function(){a("textarea.rich_text_editor").each(function(){var b=a(this);b.data("mce_applied")||(b.data("mce_applied",!0),a.asterion.dialog.visibleDialog().find(".dialog_core").spinner().show(),b.tinymce({script_url:"/tinymce/tiny_mce_src.js",forced_root_block:"p",plugins:"pagebreak,inlinepopups,inlinesourceeditor,asterion_contrast,paste,asterion_paragraph,asterion_template,table,asterion_code,asterion_charmap,asterion_link,asterion_image,asterion_youtube",inlinepopups_skin:"jigsy",mode:"none",theme:"jigsy",valid_elements:"a[*],strong/b[*],em/i[*],strike[*],u[*],#p[*],-ol[*],-ul[*],-li[*],br[*],img[*],-sub[*],-sup[*],-blockquote[*],-table[*],-tr[*],tbody[*],thead[*],tfoot[*],#td[*],#th[*],caption[*],-div[*],-span[*],-code[*],-pre[*],address[*],-h1[*],-h2[*],-h3[*],-h4[*],-h5[*],-h6[*],hr[*],-font[*],dd[*],dl[*],dt[*],cite[*],abbr[*],acronym[*],del[*],ins[*],object[*],param[name|value],embed[*],script[*],map[*],area[*],bdo[*],button[*],col[*],colgroup[*],dfn[*],fieldset[*],form[*],input[*],kbd[*],label[*],legend[*],noscript[*],optgroup[*],option[*],q[*],samp[*],select[*],small[*],textarea[*],tt[*],var[*],big",extended_valid_elements:"iframe[*],script[language|type|src],object[style|class|type|width|height|data]",verify_html:!0,width:"100%",height:"100%",browser_spellcheck:!0,tab_focus:":next",convert_urls:!1,remove_linebreaks:!1,relative_urls:!1,remove_script_host:!0,paste_remove_styles:!1,oninit:function(c){a.asterion.dialog.handleSizing(),b.trigger("oninit",c)},setup:function(b){b.onInit.add(function(){a.spinner().hide()}),b.onBeforeGetContent.add(function(a){a.dom.run(a.dom.select(".safety_break"),function(b){a.dom.remove(b)});var b=a.dom.select("body > *:last")[0];"undefined"!=typeof b&&"P"===b.nodeName&&/^\s*$/.test(b.innerHTML)&&a.dom.remove(b)}),b.onNodeChange.add(function(a){var b=a.dom.create("br",{"class":"safety_break"}),c=a.dom.select("body > *:last")[0];if("undefined"!=typeof c){var d=c.nodeName;if("TABLE"===d||"PRE"===d)a.dom.insertAfter(b,c);else if("P"===d){var e=a.dom.select("*:last",c)[0];if("undefined"!=typeof e){var f=e.nodeName;"PRE"===f&&a.dom.insertAfter(b,e)}}}})}}))})},attachToCodeEditors:function(){(0===a("#dialog_main iframe").length||0!==a(".richtext_field").length)&&a.each(a(".code_editor"),function(){var b=a("textarea",a.asterion.dialog.visibleDialog()),c=a(this).attr("class").split(" ")[1],d="html"==c?"xml":c;if("js"==c)var e=["parsejavascript.js","tokenizejavascript.js"];else e="html"==c?["parsexml.js"]:["parse"+c+".js"];var f={path:"/codemirror/js/",parserfile:e,stylesheet:"/codemirror/css/"+d+"colors.css",height:"100%",width:"960px",lineNumbers:!0,tabMode:"spaces",enterMode:"indent",autofocus:!0},g=new CodeMirror.fromTextArea(this.id,f);b.css("visibility","visible");var h=a(this),i=a.asterion.dialog.visibleDialog();h.parents("form",i).data("codeMirror",g),h.parents("form",i).submit(function(a){h.val(g.getCode()),h.trigger("save",[a,g.getCode()])})})},attachToColorPicker:function(){a.each(a(".color_picker_box"),function(){hex_raw=a(this).find(".hex_value").val(),hex_value=hex_raw.match(/^(([a-fA-F0-9]){3}){1,2}$/)?hex_raw:"FFFFFF",a(this).find(".current_picker_color").css("backgroundColor","#"+hex_value),a(this).hover(function(){a(this).find(".color_picker_container").show()},function(){a(this).find(".color_picker_container").hide()});var b=this;a(this).find(".color_picker_container").ColorPicker({flat:!0,color:"#00ff00",onChange:function(c,d){hex_value=d.match(/^(([a-fA-F0-9]){3}){1,2}$/)?d:"FFFFFF",a(b).find(".current_picker_color").css("backgroundColor","#"+hex_value),a(b).find(".hex_value").val(hex_value).trigger("colorchange")}})})}},a.createCallbacks(a.asterion.behaviors,["attach","beforeSubmit","afterSubmitFailure"]),a.asterion.behaviors.attach(a.asterion.behaviors.attachToCodeEditors),a.asterion.behaviors.attach(a.asterion.behaviors.removeScripts),a.asterion.behaviors.attach(a.asterion.behaviors.attachToGraphicalSelect),a.asterion.behaviors.attach(a.asterion.behaviors.attachToRelativeDates),a.asterion.behaviors.attach(a.asterion.behaviors.addLocationHelperClasses),a.asterion.behaviors.attach(a.asterion.behaviors.attachToColorPicker),a.asterion.commentNotification=function(b){b=b.replace(/^\s+|\s+$/g,""),b.length&&(0==a("#comments_item").length&&a("#asterion_top_row_nav").prepend('<li id="comments_item"></li>'),a("#comments_item").html(b))},a(function(){a.asterion.behaviors.attach(),a.asterion.behaviors.attachToRichTextEditors(),a(document).ajaxComplete(function(){a.asterion.behaviors.attach(),a.asterion.behaviors.attachToRichTextEditors()})}),a(document).on("click","a.ajax_link",function(b){var c=a(this).parents(".dialog_scroll_wrapper");a.ajax({url:a(this).attr("href"),dataType:"script",type:"POST",beforeSend:function(a){c.data("current_url")&&a.setRequestHeader("X-Asterion-Dialog-Referer",c.data("current_url")),a.setRequestHeader("Accept","text/javascript")}}),b.preventDefault()}),a(document).on("submit","form.ajax_form",function(){var b=this,c=a(this),d=arguments[1]||{};if(c.hasClass("disabled"))return!1;if(dialog_form_disable(b),a.asterion.behaviors.beforeSubmit(b)){var e=a(b).serialize(),f=a(b).parents(".dialog_scroll_wrapper");a.ajax({url:a(b).attr("action"),data:e,dataType:"asterionjavascript",type:"post",beforeSend:function(a){f.data("current_url")&&a.setRequestHeader("X-Asterion-Dialog-Referer",f.data("current_url"))},error:function(d,e,f){c.trigger("error",arguments),dialog_form_enable(b),a.asterion.behaviors.afterSubmitFailure(d,e,f)&&a.globalEval(d)},success:function(e){c.trigger("success",arguments),"function"==typeof b.saved&&b.saved(),("function"!=typeof d.success||d.success())&&a.globalEval(e)},complete:function(){c.trigger("complete",arguments)}})}else dialog_form_enable(b);return!1}),a(document).on("mouseenter",".asterion_selection",function(){return a(this).hasClass("inactive")?!1:(a(this).addClass("active"),void a(this).find("ul").show())}).on("mouseleave",".asterion_selection",function(){return a(this).hasClass("inactive")?!1:(a(this).removeClass("active"),void a(this).find("ul").hide())}),a(document).on("mceInlineSourceEditor.hide",function(){a(".dialog_preview").remove(),a(".asterion_dialog_submit button").show(),a("#blog_save_draft_button").show(),a("#autosave_toggle").show(),a(".massive_dialog .richtext_field").css({width:"998px"})}),a(document).on("mceInlineSourceEditor.show",function(){a(".asterion_dialog_submit button").before('<a class="dialog_preview ok dialog_button">'+I18n.t("js.rte_preview")+"</a>"),a(".dialog_preview").click(function(){a("#richtext_editor_tab").click()}),a(".massive_dialog .richtext_field").css({width:"980px"}),a(".asterion_dialog_submit button").hide(),a("#blog_save_draft_button").hide(),a("#autosave").removeAttr("checked"),a("#autosave_toggle").hide()}),a("#component_editor_container .delete_blog_post").confirmAction({title:I18n.t("js.delete_blog_post_title"),message:I18n.t("js.delete_blog_post_confirm_msg"),action_button:I18n.t("js.delete_blog_post_button"),success:function(){var b=a(this),c=b.attr("href"),d=c.split("/").pop(),e=a(".blog_post_"+d);a(document).trigger("blog.delete",d),e.attention().fadeOut();var f=a(".blog_component .paging_info b"),g=f.html();g&&(g=g.replace(/([a-zA-Z ]+)?(\d+)/,function(a,b,c){var d=parseInt(c)-1;return b&&1!=d?b+d:d}),f.html(g))}}),a(document).on("click","#dialog_wrapper .delete_blog_post",function(){var b=a(this).closest("tr"),c=a(this).attr("href"),d={};d[I18n.t("js.delete_blog_post_button")]=function(){b.css("backgroundColor","#fdd"),a.ajax({url:c,dataType:"json",type:"post",error:function(){b.css("backgroundColor","")},success:function(){a.asterion.dialog.reloadPageOnClose(),b.fadeOutAndRemove(function(){a.asterion.dialog.reload()})}}),a(this).dialog("close")},d[I18n.t("cancel")]=function(){a(this).dialog("close")};var e={title:I18n.t("js.delete_blog_post_title"),buttons:d},f=I18n.t("js.delete_blog_post_confirm_msg");return a.asterion.dialog.confirm(f,e),!1}),a(document).on("click","a.inline_delete_blog_post",function(){var b=a(this),c=b.attr("id").replace(/post_/,"");post=a(".blog_post_"+c),href=b.attr("href");var d={};d[I18n.t("js.delete_blog_post_button")]=function(){a.ajax({url:href,dataType:"json",type:"post",error:function(){},success:function(){post.fadeOutAndRemove(function(){a(".delete_post_"+c).closest("div").remove()})}}),a(this).dialog("close")},d[I18n.t("cancel")]=function(){a(this).dialog("close")};var e={title:I18n.t("js.delete_blog_post_title"),buttons:d},f=I18n.t("js.delete_blog_post_confirm_msg");return a.asterion.dialog.confirm(f,e),!1}),a(document).on("click","#categories .edit_category",function(){var b=a(this),c=a("#edit_category form"),d=b.closest("tr").find("td.name"),e=b.attr("alt");return c.data("editing",d).attr("action",b.attr("href")),a("#edit_category_name").val(e),a("#create_category").hide(),a("#edit_category").show().attention(),!1}),a(document).on("click","#edit_category .cancel_edit",function(){return a("#edit_category").fadeOut(200,function(){a("#create_category").fadeIn(200)}),!1}),a(document).on("submit","#edit_category form",function(){var b=a(this);return a.post(b.attr("action"),b.serialize(),function(c){b.data("editing").html(c).attr("alt",c).closest("tr").attention(),a("#edit_category").fadeOut(200,function(){a("#create_category").fadeIn(200)})}),!1}),a("#categories .delete_category").confirmAction({title:I18n.t("js.delete_blog_category_title"),message:function(){var b=a(this).closest("tr").find("td.name").attr("abbr");return I18n.t("js.delete_blog_category_confirm_msg",{name:"<b>"+b+"</b>"})},action_button:function(){var b=a(this).closest("tr").find("td.name").attr("abbr");return I18n.t("js.delete_blog_category_button",{name:b})},success:function(){a(this).closest("tr").attention(),a.asterion.dialog.reload()}}),a(document).on("submit","#create_category_form",function(){var b=a("#category_name");if(""==b.val())return!1;var c=a(this).serialize();return a.ajax({url:a(this).attr("action"),data:c,dataType:"json",type:"POST",error:function(){},success:function(){a.asterion.dialog.reload()}}),!1})}($j),function($){$.asterion=$.asterion||{},$.asterion.mapComponent={setupMap:function(map_element,id,data){var latlng=new google.maps.LatLng(data.center[0],data.center[1]),options={zoom:data.zoom,styles:eval(data.styles),center:latlng,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},mapTypeId:google.maps.MapTypeId.ROADMAP,navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.DEFAULT}},map=new google.maps.Map(document.getElementById(map_element),options);if(data.allow_directions===!0){var directionsDisplay=new google.maps.DirectionsRenderer({draggable:!0}),directionsPanel=map_element+"_panel";directionsDisplay.setMap(map),directionsDisplay.setPanel(document.getElementById(directionsPanel)),$j("#component_"+id+"_google_map_directions_form").submit(function(){return $j.asterion.mapComponent.directions(directionsDisplay,directionsPanel,$j("#component_"+id+"_google_map_directions_form input#start_point").val(),data.center[0]+","+data.center[1]),!1})}var marker=new google.maps.Marker({position:latlng,title:"",map:map}),markerHtml=data.marker_content;if(markerHtml){var infoWindow=new google.maps.InfoWindow({content:"<div>"+markerHtml+"</div>"});infoWindow.open(map,marker),google.maps.event.addListener(marker,"click",function(){infoWindow.open(map,marker)})}""!==data.feed_url&&$j.asterion.mapComponent.loadFeed(map,data.feed_url)},setupAdminMap:function(map,data){var admin_latlng=new google.maps.LatLng(data.center[0],data.center[1]),admin_options={zoom:data.zoom,styles:eval(data.styles),center:admin_latlng,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},mapTypeId:google.maps.MapTypeId.ROADMAP,navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.DEFAULT}},admin_map=new google.maps.Map(document.getElementById(map),admin_options);$(document).on("map_style_change",function(e){var styles=eval(e.message);admin_map.setOptions({styles:styles})});var admin_marker=new google.maps.Marker({position:admin_latlng,title:"",draggable:!0,map:admin_map});google.maps.event.addListener(admin_marker,"dragend",function(){$j("input#component_latitude").val(admin_marker.getPosition().lat()),$j("input#component_longitude").val(admin_marker.getPosition().lng())}),google.maps.event.addListener(admin_map,"zoom_changed",function(){$j("input#component_zoom").val(admin_map.getZoom())}),$j.asterion.mapComponent.adminMarker=admin_marker,$j.asterion.mapComponent.adminMap=admin_map,""!==data.feed_url&&$j.asterion.mapComponent.loadFeed(admin_map,data.feed_url)},lookupAddress:function(a){var b=$("#"+a).get(0).value,c=new google.maps.Geocoder,d=$j.asterion.mapComponent.adminMap,e=$j.asterion.mapComponent.adminMarker;c.geocode({address:b},function(a,b){if(b==google.maps.GeocoderStatus.OK){if($j("#geocode_errors").html(""),d.setCenter(a[0].geometry.location),e.setPosition(a[0].geometry.location),google.maps.event.trigger($.asterion.mapComponent.adminMarker,"dragend"),$("textarea#component_marker_content").length){$("textarea#component_marker_content").val(a[0].formatted_address);var c=a[0].formatted_address,f=new google.maps.InfoWindow({content:"<div>"+c+"</div>"});f.open(d,e)}}else $j("#geocode_errors").html(I18n.t("js.could_not_find_address",{status:b}))})},addFeed:function(a){var b=$j.asterion.mapComponent.adminMap;$j.asterion.mapComponent.loadFeed(b,a)},directions:function(a,b,c,d){var e=new google.maps.DirectionsService,f={origin:c,destination:d,travelMode:google.maps.DirectionsTravelMode.DRIVING};e.route(f,function(c,d){d==google.maps.DirectionsStatus.OK?($j("#"+b).empty(),a.setDirections(c)):$j("#"+b).empty().html("<p>"+I18n.t("js.could_not_find_route")+"<p>")})},loadFeed:function(a,b){var c=new google.maps.KmlLayer(b);c.setMap(a)}}}($j),function(a){a.asterion=a.asterion||{},a.asterion.videoPlayerComponent={updateBuffering:function(a,b){var c=$j("#"+a+" .video_player_controls .progress").width()-2*$j("#"+a+" .video_player_controls .progress .total_time").width()-25;$j("#"+a+" .video_player_controls .progress_bar").css("width",c),b?$j("#"+a+" .video_player_controls .is_buffering").css("display","block"):$j("#"+a+" .video_player_controls .is_buffering").css("display","none")},updateLoadedBytes:function(a,b,c){$j("#"+a+" .video_player_controls .loaded_bytes").text(b),$j("#"+a+" .video_player_controls .total_bytes").text(c);var d=b/c,e=$j("#"+a+" .video_player_controls .progress_bar").width(),f=e*d;$j("#"+a+" .video_player_controls .progress_bar .buffer_progress_bar").width(f),$j("#"+a+" .video_player_controls .progress_bar .panner").width(f)},updateCurrentTime:function(a,b,c,d,e){$j("#"+a+" .video_player_controls .current_time").text(d),$j("#"+a+" .video_player_controls .total_time").text(e);var f=b/c,g=$j("#"+a+" .video_player_controls .progress_bar").width(),h=g*f;$j("#"+a+" .video_player_controls .progress_bar .playback_progress_bar").width(h),$j("#"+a+" .video_player_controls .progress_bar .playhead").css("left",h+"px")},playbackComplete:function(){},playStateChange:function(a,b){"paused"==b?$j("#"+a+" .video_player_controls .playback_button").removeClass("pause_button").addClass("play_button"):"playing"==b&&$j("#"+a+" .video_player_controls .playback_button").removeClass("play_button").addClass("pause_button")},currentVolume:function(a,b){volumeChanged(a,b)},muteChanged:function(a,b){b===!0?$j("#"+a+" .video_player_controls .volume .toggle_mute").removeClass("active").addClass("muted"):$j("#"+a+" .video_player_controls .volume .toggle_mute").removeClass("muted").addClass("active")},volumeChanged:function(a,b){switch(b){case 1:$j("#"+a+" .video_player_controls .volume").removeClass("percent_66").removeClass("percent_33").removeClass("percent_0").addClass("percent_100");break;case.66:$j("#"+a+" .video_player_controls .volume").removeClass("percent_100").removeClass("percent_33").removeClass("percent_0").addClass("percent_66");break;case.33:$j("#"+a+" .video_player_controls .volume").removeClass("percent_66").removeClass("percent_100").removeClass("percent_0").addClass("percent_33");break;case 0:$j("#"+a+" .video_player_controls .volume").removeClass("percent_66").removeClass("percent_33").removeClass("percent_100").addClass("percent_0");break;default:$j("#"+a+" .video_player_controls .volume").removeClass("percent_66").removeClass("percent_33").removeClass("percent_0").addClass("percent_100")}},togglePlayback:function(a){document.getElementById(a).togglePlayback()},setVolume:function(a,b){document.getElementById(a).setVolume(b)},toggleMute:function(a){document.getElementById(a).toggleMute()},panTo:function(a,b){document.getElementById(a).panTo(b)},replay:function(a){document.getElementById(a).replay()},setup:function(a){$j("#"+a+" .video_player_container").bind("mouseenter",function(){$j(".video_player_caption",this).animate({height:"show",opacity:"show"},"slow"),$j(".video_player_controls",this).animate({height:"show",opacity:"show"},"slow")}).bind("mouseleave",function(){$j(".video_player_caption",this).animate({height:"hide",opacity:"hide"},"slow"),$j(".video_player_controls",this).animate({height:"hide",opacity:"hide"},"slow")}),$j("#"+a+" .panner").click(function(b){flash_object="video_player_"+a.replace(/component_/,"");var c=b.pageX-$j(this).offset().left,d=$j(this).width(),e=c/d,f=$j("#"+a+" .video_player_controls .total_time").text().split(":"),g=parseInt(60*f[0],10)+parseInt(f[1],10),h=g*e;$j.asterion.videoPlayerComponent.panTo(flash_object,h)})}}}($j),function(a){a.fn.asterion_expandable=function(b){var c=b.url||"",d=b.params||{},e=b.template||function(){return I18n.t("js.no_template_found")},f=function(){var b=a(this),f=!1,g=function(b){var g=a(b.target),h=function(b){f=!1,g.removeClass("loading"),g.after(e(b)),a(g.siblings()[0]).slideToggle(),g.toggleClass("expand collapsed")};g.is("a")&&g.parent().is("li")&&(0===g.siblings().length&&f!==!0?(g.addClass("loading"),f=!0,a.ajax({type:"GET",url:c+g.attr("id"),data:d,cache:!1,success:h,dataType:"json"})):f!==!0&&(a(g.siblings()[0]).slideToggle(),g.toggleClass("expand collapsed")))};b.bind("click",g)};return this.each(f)}}($j),function(a){function b(){return url=location.href,hashtag=-1!==url.indexOf("#prettyPhoto")?decodeURI(url.substring(url.indexOf("#prettyPhoto")+1,url.length)):!1}function c(){"undefined"!=typeof theRel&&(location.hash=theRel+"/"+rel_index+"/")}function d(){-1!==location.href.indexOf("#prettyPhoto")&&(location.hash="prettyPhoto")}function e(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null==e?"":e[1]}var f=!1;a.prettyPhoto={version:"3.1.4"},a.fn.prettyPhoto=function(g){function h(){a(".pp_loaderIcon").hide(),projectedTop=scroll_pos.scrollTop+(B/2-s.containerHeight/2),0>projectedTop&&(projectedTop=0),$ppt.fadeTo(settings.animation_speed,1),$pp_pic_holder.find(".pp_content").animate({height:s.contentHeight,width:s.contentWidth},settings.animation_speed),$pp_pic_holder.animate({top:projectedTop,left:C/2-s.containerWidth/2<0?0:C/2-s.containerWidth/2,width:s.containerWidth},settings.animation_speed,function(){$pp_pic_holder.find(".pp_hoverContainer,#fullResImage").height(s.height).width(s.width),$pp_pic_holder.find(".pp_fade").fadeIn(settings.animation_speed),isSet&&"image"==m(pp_images[set_position])?$pp_pic_holder.find(".pp_hoverContainer").show():$pp_pic_holder.find(".pp_hoverContainer").hide(),settings.allow_expand&&(s.resized?a("a.pp_expand,a.pp_contract").show():a("a.pp_expand").hide()),!settings.autoplay_slideshow||y||t||a.prettyPhoto.startSlideshow(),a.isFunction(settings.changepicturecallback)&&settings.changepicturecallback(),t=!0}),q(),a.isFunction(g.ajaxcallback)&&g.ajaxcallback()}function i(b){$pp_pic_holder.find("#pp_full_res object,#pp_full_res embed").css("visibility","hidden"),$pp_pic_holder.find(".pp_fade").fadeOut(settings.animation_speed,function(){a(".pp_loaderIcon").show(),a.isFunction(b)&&b()})}function j(b){b>1?a(".pp_nav").show():a(".pp_nav").hide()}function k(a,b){if(resized=!1,l(a,b),imageWidth=a,imageHeight=b,(x>C||w>B)&&doresize&&settings.allow_resize&&!A){for(resized=!0,fitting=!1;!fitting;)x>C?(imageWidth=C-200,imageHeight=b/a*imageWidth):w>B?(imageHeight=B-200,imageWidth=a/b*imageHeight):fitting=!0,w=imageHeight,x=imageWidth;l(imageWidth,imageHeight),(x>C||w>B)&&k(x,w)}return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(w),containerWidth:Math.floor(x)+2*settings.horizontal_padding,contentHeight:Math.floor(u),contentWidth:Math.floor(v),resized:resized}}function l(b,c){b=parseFloat(b),c=parseFloat(c),$pp_details=$pp_pic_holder.find(".pp_details"),$pp_details.width(b),detailsHeight=parseFloat($pp_details.css("marginTop"))+parseFloat($pp_details.css("marginBottom")),$pp_details=$pp_details.clone().addClass(settings.theme).width(b).appendTo(a("body")).css({position:"absolute",top:-1e4}),detailsHeight+=$pp_details.height(),detailsHeight=34>=detailsHeight?36:detailsHeight,a.browser.msie&&7==a.browser.version&&(detailsHeight+=8),$pp_details.remove(),$pp_title=$pp_pic_holder.find(".ppt"),titleHeight=parseFloat($pp_title.css("marginTop"))+parseFloat($pp_title.css("marginBottom")),$pp_title=$pp_title.clone().appendTo(a("body")).css({position:"absolute",top:-1e4}),titleHeight+=$pp_title.height(),$pp_title.remove(),u=c+detailsHeight,v=b,w=u+titleHeight+$pp_pic_holder.find(".pp_top").height()+$pp_pic_holder.find(".pp_bottom").height(),x=b}function m(a){return a.match(/youtube\.com\/watch/i)||a.match(/youtu\.be/i)?"youtube":a.match(/vimeo\.com/i)?"vimeo":a.match(/\b.mov\b/i)?"quicktime":a.match(/\b.swf\b/i)?"flash":a.match(/\biframe=true\b/i)?"iframe":a.match(/\bajax=true\b/i)?"ajax":a.match(/\bcustom=true\b/i)?"custom":"#"==a.substr(0,1)?"inline":"image"}function n(){if(doresize&&"undefined"!=typeof $pp_pic_holder){if(scroll_pos=o(),contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width(),projectedTop=B/2+scroll_pos.scrollTop-contentHeight/2,0>projectedTop&&(projectedTop=0),contentHeight>B)return;$pp_pic_holder.css({top:projectedTop,left:C/2+scroll_pos.scrollLeft-contentwidth/2})}}function o(){return self.pageYOffset?{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}:document.documentElement&&document.documentElement.scrollTop?{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}:document.body?{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}:void 0}function p(){B=a(window).height(),C=a(window).width(),"undefined"!=typeof $pp_overlay&&$pp_overlay.height(a(document).height()).width(C)}function q(){isSet&&settings.overlay_gallery&&"image"==m(pp_images[set_position])&&settings.ie6_fallback&&(!a.browser.msie||6!=parseInt(a.browser.version))?(itemWidth=57,navWidth="facebook"==settings.theme||"pp_default"==settings.theme?50:30,itemsPerPage=Math.floor((s.containerWidth-100-navWidth)/itemWidth),itemsPerPage=itemsPerPage<pp_images.length?itemsPerPage:pp_images.length,totalPage=Math.ceil(pp_images.length/itemsPerPage)-1,0==totalPage?(navWidth=0,$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").hide()):$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").show(),galleryWidth=itemsPerPage*itemWidth,fullGalleryWidth=pp_images.length*itemWidth,$pp_gallery.css("margin-left",-(galleryWidth/2+navWidth/2)).find("div:first").width(galleryWidth+5).find("ul").width(fullGalleryWidth).find("li.selected").removeClass("selected"),goToPage=Math.floor(set_position/itemsPerPage)<totalPage?Math.floor(set_position/itemsPerPage):totalPage,a.prettyPhoto.changeGalleryPage(goToPage),$pp_gallery_li.filter(":eq("+set_position+")").addClass("selected")):$pp_pic_holder.find(".pp_content").unbind("mouseenter mouseleave")}function r(){if(settings.social_tools&&(facebook_like_link=settings.social_tools.replace("{location_href}",encodeURIComponent(location.href))),settings.markup=settings.markup.replace("{pp_social}",""),a("body").append(settings.markup),$pp_pic_holder=a(".pp_pic_holder"),$ppt=a(".ppt"),$pp_overlay=a("div.pp_overlay"),isSet&&settings.overlay_gallery){currentGalleryPage=0,toInject="";for(var b=0;b<pp_images.length;b++)pp_images[b].match(/\b(jpg|jpeg|png|gif)\b/gi)?(classname="",img_src=pp_images[b]):(classname="default",img_src=""),toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>";toInject=settings.gallery_markup.replace(/{gallery}/g,toInject),$pp_pic_holder.find("#pp_full_res").after(toInject),$pp_gallery=a(".pp_pic_holder .pp_gallery"),$pp_gallery_li=$pp_gallery.find("li"),$pp_gallery.find(".pp_arrow_next").click(function(){return a.prettyPhoto.changeGalleryPage("next"),a.prettyPhoto.stopSlideshow(),!1}),$pp_gallery.find(".pp_arrow_previous").click(function(){return a.prettyPhoto.changeGalleryPage("previous"),a.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_content").hover(function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeIn()},function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeOut()}),itemWidth=57,$pp_gallery_li.each(function(b){a(this).find("a").click(function(){return a.prettyPhoto.changePage(b),a.prettyPhoto.stopSlideshow(),!1})})}settings.slideshow&&($pp_pic_holder.find(".pp_nav").prepend('<a href="#" class="pp_play">Play</a>'),$pp_pic_holder.find(".pp_nav .pp_play").click(function(){return a.prettyPhoto.startSlideshow(),!1})),$pp_pic_holder.attr("class","pp_pic_holder "+settings.theme),$pp_overlay.css({opacity:0,height:a(document).height(),width:a(window).width()}).bind("click",function(){settings.modal||a.prettyPhoto.close()}),a("a.pp_close").bind("click",function(){return a.prettyPhoto.close(),!1}),settings.allow_expand&&a("a.pp_expand").bind("click",function(){return a(this).hasClass("pp_expand")?(a(this).removeClass("pp_expand").addClass("pp_contract"),doresize=!1):(a(this).removeClass("pp_contract").addClass("pp_expand"),doresize=!0),i(function(){a.prettyPhoto.open()}),!1}),$pp_pic_holder.find(".pp_previous, .pp_nav .pp_arrow_previous").bind("click",function(){return a.prettyPhoto.changePage("previous"),a.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_next, .pp_nav .pp_arrow_next").bind("click",function(){return a.prettyPhoto.changePage("next"),a.prettyPhoto.stopSlideshow(),!1}),n()}g=jQuery.extend({gallery_url:!1,hook:"rel",animation_speed:"fast",ajaxcallback:function(){},slideshow:5e3,autoplay_slideshow:!1,opacity:.8,show_title:!0,allow_resize:!0,allow_expand:!0,default_width:500,default_height:344,counter_separator_label:"/",theme:"pp_default",horizontal_padding:20,hideflash:!1,wmode:"opaque",autoplay:!0,modal:!1,deeplinking:!0,overlay_gallery:!0,overlay_gallery_max:30,keyboard_shortcuts:!0,changepicturecallback:function(){},callback:function(){},ie6_fallback:!0,markup:'<div class="pp_pic_holder">       <div class="ppt">        <a class="pp_close" href="#">Close</a>               <span>&nbsp;</span>             </div>       <div class="pp_top">        <div class="pp_left"></div>        <div class="pp_middle"></div>        <div class="pp_right"></div>       </div>       <div class="pp_content_container">        <div class="pp_left">        <div class="pp_right">         <div class="pp_content">          <div class="pp_loaderIcon"></div>          <div class="pp_fade">               <a href="#" class="pp_expand" title="Expand the image">Expand</a>           <div class="pp_hoverContainer">            <a class="pp_next" href="#">next</a>            <a class="pp_previous" href="#">previous</a>           </div>           <div id="pp_full_res"></div>           <div class="pp_details">            <div class="pp_nav">             <a href="#" class="pp_arrow_previous">Previous</a>             <p class="currentTextHolder">0/0</p>             <a href="#" class="pp_arrow_next">Next</a>            </div>            <p class="pp_description"></p>            <div class="pp_social">{pp_social}</div>           </div>          </div>         </div>        </div>        </div>       </div>       <div class="pp_bottom">        <div class="pp_left"></div>        <div class="pp_middle"></div>        <div class="pp_right"></div>       </div>      </div>      <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery">         <a href="#" class="pp_arrow_previous">Previous</a>         <div>          <ul>           {gallery}          </ul>         </div>         <a href="#" class="pp_arrow_next">Next</a>        </div>',image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:"",social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},g);
var s,t,u,v,w,x,y,z=this,A=!1,B=a(window).height(),C=a(window).width();return doresize=!0,scroll_pos=o(),a(window).unbind("resize.prettyphoto").bind("resize.prettyphoto",function(){n(),p()}),g.keyboard_shortcuts&&a(document).unbind("keydown.prettyphoto").bind("keydown.prettyphoto",function(b){if("undefined"!=typeof $pp_pic_holder&&$pp_pic_holder.is(":visible"))switch(b.keyCode){case 37:a.prettyPhoto.changePage("previous"),b.preventDefault();break;case 39:a.prettyPhoto.changePage("next"),b.preventDefault();break;case 27:settings.modal||a.prettyPhoto.close(),b.preventDefault()}}),a.prettyPhoto.initialize=function(){function b(){pp_images.length>settings.overlay_gallery_max&&(settings.overlay_gallery=!1),set_position=jQuery.inArray(c.attr("href"),pp_images),rel_index=isSet?set_position:a("a["+settings.hook+"^='"+theRel+"']").index(c),r(c[0]),settings.allow_resize&&a(window).bind("scroll.prettyphoto",function(){n()}),a.prettyPhoto.open()}settings=g,"pp_default"==settings.theme&&(settings.horizontal_padding=16),settings.ie6_fallback&&a.browser.msie&&6==parseInt(a.browser.version)&&(settings.theme="light_square"),theRel=a(this).attr(settings.hook),galleryRegExp=/\[(?:.*)\]/,isSet=galleryRegExp.exec(theRel)?!0:!1,pp_images=pp_titles=pp_descriptions=[],set_position=0,rel_index=0;var c=a(this);return settings.gallery_url?0==f&&(f=!0,$j.ajax({url:settings.gallery_url,dataType:"json",success:function(a){f=!1,pp_images=a.images,pp_titles=a.titles,pp_descriptions=a.descriptions,b()}})):(pp_images=isSet?jQuery.map(z,function(b){return-1!=a(b).attr(settings.hook).indexOf(theRel)?a(b).attr("href"):void 0}):a.makeArray(a(this).attr("href")),pp_titles=isSet?jQuery.map(z,function(b){return-1!=a(b).attr(settings.hook).indexOf(theRel)?a(b).find("img").attr("alt")?a(b).find("img").attr("alt"):"":void 0}):a.makeArray(a(this).find("img").attr("alt")),pp_descriptions=isSet?jQuery.map(z,function(b){return-1!=a(b).attr(settings.hook).indexOf(theRel)?a(b).attr("title")?a(b).attr("title"):"":void 0}):a.makeArray(a(this).attr("title")),b()),!1},a.prettyPhoto.open=function(b){return"undefined"==typeof settings&&(settings=g,a.browser.msie&&6==a.browser.version&&(settings.theme="light_square"),pp_images=a.makeArray(arguments[0]),pp_titles=a.makeArray(arguments[1]?arguments[1]:""),pp_descriptions=a.makeArray(arguments[2]?arguments[2]:""),isSet=pp_images.length>1?!0:!1,set_position=arguments[3]?arguments[3]:0,r(b.target)),a.browser.msie&&6==a.browser.version&&a("select").css("visibility","hidden"),settings.hideflash&&a("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css("visibility","hidden"),j(a(pp_images).size()),a(".pp_loaderIcon").show(),settings.deeplinking&&c(),settings.social_tools&&(facebook_like_link=settings.social_tools.replace("{location_href}",encodeURIComponent(location.href)),$pp_pic_holder.find(".pp_social").html(facebook_like_link)),$ppt.is(":hidden")&&$ppt.css("opacity",0).show(),$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity),$pp_pic_holder.find(".currentTextHolder").text(set_position+1+settings.counter_separator_label+a(pp_images).size()),"undefined"!=typeof pp_descriptions[set_position]&&""!=pp_descriptions[set_position]?$pp_pic_holder.find(".pp_description").show().html(unescape(pp_descriptions[set_position])):$pp_pic_holder.find(".pp_description").hide(),movie_width=parseFloat(e("width",pp_images[set_position]))?e("width",pp_images[set_position]):settings.default_width.toString(),movie_height=parseFloat(e("height",pp_images[set_position]))?e("height",pp_images[set_position]):settings.default_height.toString(),A=!1,-1!=movie_height.indexOf("%")&&(movie_height=parseFloat(a(window).height()*parseFloat(movie_height)/100-150),A=!0),-1!=movie_width.indexOf("%")&&(movie_width=parseFloat(a(window).width()*parseFloat(movie_width)/100-150),A=!0),$pp_pic_holder.fadeIn(function(){switch($ppt.find("span").html(settings.show_title&&""!=pp_titles[set_position]&&"undefined"!=typeof pp_titles[set_position]?unescape(pp_titles[set_position]):"&nbsp;"),imgPreloader="",skipInjection=!1,m(pp_images[set_position])){case"image":imgPreloader=new Image,nextImage=new Image,isSet&&set_position<a(pp_images).size()-1&&(nextImage.src=pp_images[set_position+1]),prevImage=new Image,isSet&&pp_images[set_position-1]&&(prevImage.src=pp_images[set_position-1]),$pp_pic_holder.find("#pp_full_res")[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]),imgPreloader.onload=function(){s=k(imgPreloader.width,imgPreloader.height),h()},imgPreloader.onerror=function(){alert("Image cannot be loaded. Make sure the path is correct and image exist."),a.prettyPhoto.close()},imgPreloader.src=pp_images[set_position];break;case"youtube":s=k(movie_width,movie_height),movie_id=e("v",pp_images[set_position]),""==movie_id&&(movie_id=pp_images[set_position].split("youtu.be/"),movie_id=movie_id[1],movie_id.indexOf("?")>0&&(movie_id=movie_id.substr(0,movie_id.indexOf("?"))),movie_id.indexOf("&")>0&&(movie_id=movie_id.substr(0,movie_id.indexOf("&")))),movie="http://www.youtube.com/embed/"+movie_id,movie+=e("rel",pp_images[set_position])?"?rel="+e("rel",pp_images[set_position]):"?rel=1",settings.autoplay&&(movie+="&autoplay=1"),toInject=settings.iframe_markup.replace(/{width}/g,s.width).replace(/{height}/g,s.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case"vimeo":s=k(movie_width,movie_height),movie_id=pp_images[set_position];var b=/http:\/\/(www\.)?vimeo.com\/(\d+)/,c=movie_id.match(b);movie="http://player.vimeo.com/video/"+c[2]+"?title=0&amp;byline=0&amp;portrait=0",settings.autoplay&&(movie+="&autoplay=1;"),vimeo_width=s.width+"/embed/?moog_width="+s.width,toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,s.height).replace(/{path}/g,movie);break;case"quicktime":s=k(movie_width,movie_height),s.height+=15,s.contentHeight+=15,s.containerHeight+=15,toInject=settings.quicktime_markup.replace(/{width}/g,s.width).replace(/{height}/g,s.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case"flash":s=k(movie_width,movie_height),flash_vars=pp_images[set_position],flash_vars=flash_vars.substring(pp_images[set_position].indexOf("flashvars")+10,pp_images[set_position].length),filename=pp_images[set_position],filename=filename.substring(0,filename.indexOf("?")),toInject=settings.flash_markup.replace(/{width}/g,s.width).replace(/{height}/g,s.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+"?"+flash_vars);break;case"iframe":s=k(movie_width,movie_height),frame_url=pp_images[set_position],frame_url=frame_url.substr(0,frame_url.indexOf("iframe")-1),toInject=settings.iframe_markup.replace(/{width}/g,s.width).replace(/{height}/g,s.height).replace(/{path}/g,frame_url);break;case"ajax":doresize=!1,s=k(movie_width,movie_height),doresize=!0,skipInjection=!0,a.get(pp_images[set_position],function(a){toInject=settings.inline_markup.replace(/{content}/g,a),$pp_pic_holder.find("#pp_full_res")[0].innerHTML=toInject,h()});break;case"custom":s=k(movie_width,movie_height),toInject=settings.custom_markup;break;case"inline":myClone=a(pp_images[set_position]).clone().append('<br clear="all" />').css({width:settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo(a("body")).show(),doresize=!1,s=k(a(myClone).width(),a(myClone).height()),doresize=!0,a(myClone).remove(),toInject=settings.inline_markup.replace(/{content}/g,a(pp_images[set_position]).html())}imgPreloader||skipInjection||($pp_pic_holder.find("#pp_full_res")[0].innerHTML=toInject,h())}),!1},a.prettyPhoto.changePage=function(b){currentGalleryPage=0,"previous"==b?(set_position--,0>set_position&&(set_position=a(pp_images).size()-1)):"next"==b?(set_position++,set_position>a(pp_images).size()-1&&(set_position=0)):set_position=b,rel_index=set_position,doresize||(doresize=!0),settings.allow_expand&&a(".pp_contract").removeClass("pp_contract").addClass("pp_expand"),i(function(){a.prettyPhoto.open()})},a.prettyPhoto.changeGalleryPage=function(a){"next"==a?(currentGalleryPage++,currentGalleryPage>totalPage&&(currentGalleryPage=0)):"previous"==a?(currentGalleryPage--,0>currentGalleryPage&&(currentGalleryPage=totalPage)):currentGalleryPage=a,slide_speed="next"==a||"previous"==a?settings.animation_speed:0,slide_to=currentGalleryPage*itemsPerPage*itemWidth,$pp_gallery.find("ul").animate({left:-slide_to},slide_speed)},a.prettyPhoto.startSlideshow=function(){"undefined"==typeof y?($pp_pic_holder.find(".pp_play").unbind("click").removeClass("pp_play").addClass("pp_pause").click(function(){return a.prettyPhoto.stopSlideshow(),!1}),y=setInterval(a.prettyPhoto.startSlideshow,settings.slideshow)):a.prettyPhoto.changePage("next")},a.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find(".pp_pause").unbind("click").removeClass("pp_pause").addClass("pp_play").click(function(){return a.prettyPhoto.startSlideshow(),!1}),clearInterval(y),y=void 0},a.prettyPhoto.close=function(){$pp_overlay.is(":animated")||(a.prettyPhoto.stopSlideshow(),$pp_pic_holder.stop().find("object,embed").css("visibility","hidden"),a("div.pp_pic_holder,div.ppt,.pp_fade").fadeOut(settings.animation_speed,function(){a(this).remove()}),$pp_overlay.fadeOut(settings.animation_speed,function(){a.browser.msie&&6==a.browser.version&&a("select").css("visibility","visible"),settings.hideflash&&a("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css("visibility","visible"),a(this).remove(),a(window).unbind("scroll.prettyphoto"),d(),a.isFunction(settings.callback)&&settings.callback(),doresize=!0,t=!1,delete settings}))},!pp_alreadyInitialized&&b()&&(pp_alreadyInitialized=!0,hashIndex=b(),hashRel=hashIndex,hashIndex=hashIndex.substring(hashIndex.indexOf("/")+1,hashIndex.length-1),hashRel=hashRel.substring(0,hashRel.indexOf("/")),setTimeout(function(){a("a["+g.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger("click")},50)),this.unbind("click.prettyphoto").bind("click.prettyphoto",a.prettyPhoto.initialize)}}(jQuery);var pp_alreadyInitialized=!1;!function(a){var b,c=this,d=c.document,e=a(d),f=a(c),g=Array.prototype,h=1.27,i=!0,j=3e4,k=!1,l=navigator.userAgent.toLowerCase(),m=c.location.hash.replace(/#\//,""),n=function(){},o=function(){return!1},p=function(){var a=3,c=d.createElement("div"),e=c.getElementsByTagName("i");do c.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->";while(e[0]);return a>4?a:b}(),q=function(){return{html:d.documentElement,body:d.body,head:d.getElementsByTagName("head")[0],title:d.title}},r="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",s=function(){var b=[];return a.each(r.split(" "),function(a,c){b.push(c),/_/.test(c)&&b.push(c.replace(/_/g,""))}),b}(),t=function(b){var c;return"object"!=typeof b?b:(a.each(b,function(d,e){/^[a-z]+_/.test(d)&&(c="",a.each(d.split("_"),function(a,b){c+=a>0?b.substr(0,1).toUpperCase()+b.substr(1):b}),b[c]=e,delete b[d])}),b)},u=function(b){return a.inArray(b,s)>-1?Galleria[b.toUpperCase()]:b},v={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(a){return"http://www.youtube.com/embed/"+a},getThumb:function(b,c,d){d=d||n,a.getJSON("http://gdata.youtube.com/feeds/api/videos/"+b+"?v=2&alt=json-in-script&callback=?",function(a){try{c(a.entry.media$group.media$thumbnail[0].url)}catch(b){d()}}).error(d)}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(a){return"http://player.vimeo.com/video/"+a},getThumb:function(b,c,d){d=d||n,a.getJSON("http://vimeo.com/api/v2/video/"+b+".json?callback=?",function(a){try{c(a[0].thumbnail_medium)}catch(b){d()}}).error(d)}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(a){return"http://www.dailymotion.com/embed/video/"+a},getThumb:function(b,c,d){d=d||n,a.getJSON("https://api.dailymotion.com/video/"+b+"?fields=thumbnail_medium_url&callback=?",function(a){try{c(a.thumbnail_medium_url)}catch(b){d()}}).error(d)}}},w=function(a){var b;for(var c in v)if(b=a&&a.match(v[c].reg),b&&b.length)return{id:b[2],provider:c};return!1},x={trunk:{},add:function(a,b,d,e){if(a=a||(new Date).getTime(),e=e||!1,this.clear(a),e){var f=b;b=function(){f(),x.add(a,b,d)}}this.trunk[a]=c.setTimeout(b,d)},clear:function(a){var b,d=function(a){c.clearTimeout(this.trunk[a]),delete this.trunk[a]};if(a&&a in this.trunk)d.call(x,a);else if("undefined"==typeof a)for(b in this.trunk)this.trunk.hasOwnProperty(b)&&d.call(x,b)}},y=[],z=[],A=!1,B=!1,C=[],D=function(b){Galleria.theme=b,a.each(C,function(a,b){b._initialized||b._init.call(b)})},E=function(){return{array:function(a){return g.slice.call(a,0)},create:function(a,b){b=b||"div";var c=d.createElement(b);return c.className=a,c},getScriptPath:function(b){b=b||a("script:last").attr("src");var c=b.split("/");return 1==c.length?"":(c.pop(),c.join("/")+"/")},animate:function(){var b,e,f,g,h,i,j,k=function(a){var b,d="transition WebkitTransition MozTransition OTransition".split(" ");if(c.opera)return!1;for(b=0;d[b];b++)if("undefined"!=typeof a[d[b]])return d[b];return!1}((d.body||d.documentElement).style),l={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[k],m={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},o=function(b,c,d){var e={};d=d||"transition",a.each("webkit moz ms o".split(" "),function(){e["-"+this+"-"+d]=c}),b.css(e)},p=function(a){o(a,"none","transition"),Galleria.WEBKIT&&Galleria.TOUCH&&(o(a,"translate3d(0,0,0)","transform"),a.data("revert")&&(a.css(a.data("revert")),a.data("revert",null)))};return function(d,q,r){return r=a.extend({duration:400,complete:n,stop:!1},r),d=a(d),r.duration?k?(r.stop&&(d.unbind(l),p(d)),b=!1,a.each(q,function(a,c){j=d.css(a),E.parseValue(j)!=E.parseValue(c)&&(b=!0),d.css(a,j)}),b?(e=[],f=r.easing in m?m[r.easing]:m._default,g=" "+r.duration+"ms cubic-bezier("+f.join(",")+")",void c.setTimeout(function(b,c,d,f){return function(){b.one(c,function(a){return function(){p(a),r.complete.call(a[0])}}(b)),Galleria.WEBKIT&&Galleria.TOUCH&&(h={},i=[0,0,0],a.each(["left","top"],function(a,c){c in d&&(i[a]=E.parseValue(d[c])-E.parseValue(b.css(c))+"px",h[c]=d[c],delete d[c])}),(i[0]||i[1])&&(b.data("revert",h),e.push("-webkit-transform"+f),o(b,"translate3d("+i.join(",")+")","transform"))),a.each(d,function(a){e.push(a+f)}),o(b,e.join(",")),b.css(d)}}(d,l,q,g),2)):void c.setTimeout(function(){r.complete.call(d[0])},r.duration)):void d.animate(q,r):(d.css(q),void r.complete.call(d[0]))}}(),removeAlpha:function(a){if(9>p&&a){var b=a.style,c=a.currentStyle,d=c&&c.filter||b.filter||"";/alpha/.test(d)&&(b.filter=d.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(b,c){b=a(b),b.attr("style")&&b.data("styles",b.attr("style")).removeAttr("style"),b.css(c)},revertStyles:function(){a.each(E.array(arguments),function(b,c){c=a(c),c.removeAttr("style"),c.attr("style",""),c.data("styles")&&c.attr("style",c.data("styles")).data("styles",null)})},moveOut:function(a){E.forceStyles(a,{position:"absolute",left:-1e4})},moveIn:function(){E.revertStyles.apply(E,E.array(arguments))},elem:function(b){return b instanceof a?{$:b,dom:b[0]}:{$:a(b),dom:b}},hide:function(a,b,c){c=c||n;var d=E.elem(a),e=d.$;a=d.dom,e.data("opacity")||e.data("opacity",e.css("opacity"));var f={opacity:0};if(b){var g=9>p&&a?function(){E.removeAlpha(a),a.style.visibility="hidden",c.call(a)}:c;E.animate(a,f,{duration:b,complete:g,stop:!0})}else 9>p&&a?(E.removeAlpha(a),a.style.visibility="hidden"):e.css(f)},show:function(a,b,c){c=c||n;var d=E.elem(a),e=d.$;a=d.dom;var f=parseFloat(e.data("opacity"))||1,g={opacity:f};if(b){9>p&&(e.css("opacity",0),a.style.visibility="visible");var h=9>p&&a?function(){1==g.opacity&&E.removeAlpha(a),c.call(a)}:c;E.animate(a,g,{duration:b,complete:h,stop:!0})}else 9>p&&1==g.opacity&&a?(E.removeAlpha(a),a.style.visibility="visible"):e.css(g)},optimizeTouch:function(){var b,c,d,e,f={},g=function(b){b.preventDefault(),f=a.extend({},b,!0)},h=function(){this.evt=f},i=function(){this.handler.call(b,this.evt)};return function(f){a(f).bind("touchend",function(f){for(b=f.target,e=!0;b.parentNode&&b!=f.currentTarget&&e;)c=a(b).data("events"),d=a(b).data("fakes"),c&&"click"in c?(e=!1,f.preventDefault(),a(b).click(g).click(),c.click.pop(),a.each(c.click,h),a(b).data("fakes",c.click),delete c.click):d&&(e=!1,f.preventDefault(),a.each(d,i)),b=b.parentNode})}}(),addTimer:function(){return x.add.apply(x,E.array(arguments)),this},clearTimer:function(){return x.clear.apply(x,E.array(arguments)),this},wait:function(b){b=a.extend({until:o,success:n,error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},b);var d,e,f=E.timestamp(),g=function(){return e=E.timestamp(),d=e-f,b.until(d)?(b.success(),!1):"number"==typeof b.timeout&&e>=f+b.timeout?(b.error(),!1):void c.setTimeout(g,10)};c.setTimeout(g,10)},toggleQuality:function(a,b){7!==p&&8!==p||!a||"IMG"!=a.nodeName.toUpperCase()||("undefined"==typeof b&&(b="nearest-neighbor"===a.style.msInterpolationMode),a.style.msInterpolationMode=b?"bicubic":"nearest-neighbor")},insertStyleTag:function(a){var b=d.createElement("style");if(q().head.appendChild(b),b.styleSheet)b.styleSheet.cssText=a;else{var c=d.createTextNode(a);b.appendChild(c)}},loadScript:function(b,c){var d=!1,e=a("<script>").attr({src:b,async:!0}).get(0);e.onload=e.onreadystatechange=function(){d||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(d=!0,e.onload=e.onreadystatechange=null,"function"==typeof c&&c.call(this,this))},q().head.appendChild(e)},parseValue:function(a){if("number"==typeof a)return a;if("string"==typeof a){var b=a.match(/\-?\d|\./g);return b&&b.constructor===Array?1*b.join(""):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(e,f,g){var h,i,j=!1,k=function(){var a=new Image;a.onload=a.onerror=function(){a=null,j=!0},a.src=e};return a("link[rel=stylesheet]").each(function(){return new RegExp(e).test(this.href)?(h=this,!1):void 0}),"function"==typeof f&&(g=f,f=b),g=g||n,h?(g.call(h,h),h):(i=d.styleSheets.length,a("#"+f).length?(a("#"+f).attr("href",e),i--,j=!0):(h=a("<link>").attr({rel:"stylesheet",href:e,id:f}).get(0),c.setTimeout(function(){var b=a('link[rel="stylesheet"], style');if(b.length?b.get(0).parentNode.insertBefore(h,b[0]):q().head.appendChild(h),p){if(i>=31)return void Galleria.raise("You have reached the browser stylesheet limit (31)",!0);h.onreadystatechange=function(){j||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(j=!0)}}else{var f=d.createElement("a"),g=c.location;f.href=e,/file/.test(g.protocol)||g.hostname!=f.hostname||g.port!=f.port||g.protocol!=f.protocol?k():a.ajax({url:e,success:function(){j=!0},error:k})}},10)),"function"==typeof g&&E.wait({until:function(){return j&&d.styleSheets.length>i},success:function(){c.setTimeout(function(){g.call(h,h)},100)},error:function(){Galleria.raise("Theme CSS could not load",!0)},timeout:1e4}),h)}}}(),F=function(){var b=function(b,c,d,e){var f=this.getOptions("easing"),g=this.getStageWidth(),h={left:g*(b.rewind?-1:1)},i={left:0};d?(h.opacity=0,i.opacity=1):h.opacity=1,a(b.next).css(h),E.animate(b.next,i,{duration:b.speed,complete:function(a){return function(){c(),a.css({left:0})}}(a(b.next).add(b.prev)),queue:!1,easing:f}),e&&(b.rewind=!b.rewind),b.prev&&(h={left:0},i={left:g*(b.rewind?1:-1)},d&&(h.opacity=1,i.opacity=0),a(b.prev).css(h),E.animate(b.prev,i,{duration:b.speed,queue:!1,easing:f,complete:function(){a(this).css("opacity",0)}}))};return{fade:function(b,c){a(b.next).css({opacity:0,left:0}).show(),E.animate(b.next,{opacity:1},{duration:b.speed,complete:c}),b.prev&&(a(b.prev).css("opacity",1).show(),E.animate(b.prev,{opacity:0},{duration:b.speed}))},flash:function(b,c){a(b.next).css({opacity:0,left:0}),b.prev?E.animate(b.prev,{opacity:0},{duration:b.speed/2,complete:function(){E.animate(b.next,{opacity:1},{duration:b.speed,complete:c})}}):E.animate(b.next,{opacity:1},{duration:b.speed,complete:c})},pulse:function(b,c){b.prev&&a(b.prev).hide(),a(b.next).css({opacity:0,left:0}).show(),E.animate(b.next,{opacity:1},{duration:b.speed,complete:c})},slide:function(){b.apply(this,E.array(arguments))},fadeslide:function(){b.apply(this,E.array(arguments).concat([!0]))},doorslide:function(){b.apply(this,E.array(arguments).concat([!1,!0]))}}}();Galleria=function(){var g=this;this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=b,this._id=parseInt(1e4*Math.random(),10);var h="container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip",i="current total";a.each(h.split(" "),function(a,b){g._dom[b]=E.create("galleria-"+b)}),a.each(i.split(" "),function(a,b){g._dom[b]=E.create("galleria-"+b,"span")});var j=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(a){var b=a.keyCode||a.which;b in j.map&&"function"==typeof j.map[b]&&j.map[b].call(g,a)},attach:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=b.toUpperCase(),c in j.keys?j.map[j.keys[c]]=a[b]:j.map[c]=a[b]);j.bound||(j.bound=!0,e.bind("keydown",j.press))},detach:function(){j.bound=!1,j.map={},e.unbind("keydown",j.press)}},k=this._controls={0:b,1:b,active:0,swap:function(){k.active=k.active?0:1},getActive:function(){return k[k.active]},getNext:function(){return k[1-k.active]}},l=this._carousel={next:g.$("thumb-nav-right"),prev:g.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var b=0,c=0,d=[0];a.each(g._thumbnails,function(e,f){f.ready&&(b+=f.outerWidth||a(f.container).outerWidth(!0),d[e+1]=b,c=Math.max(c,f.outerHeight||a(f.container).outerHeight(!0)))}),g.$("thumbnails").css({width:b,height:c}),l.max=b,l.hooks=d,l.width=g.$("thumbnails-list").width(),l.setClasses(),g.$("thumbnails-container").toggleClass("galleria-carousel",b>l.width),l.width=g.$("thumbnails-list").width()},bindControls:function(){var a;l.next.bind("click",function(b){if(b.preventDefault(),"auto"===g._options.carouselSteps){for(a=l.current;a<l.hooks.length;a++)if(l.hooks[a]-l.hooks[l.current]>l.width){l.set(a-2);break}}else l.set(l.current+g._options.carouselSteps)}),l.prev.bind("click",function(b){if(b.preventDefault(),"auto"===g._options.carouselSteps)for(a=l.current;a>=0;a--){if(l.hooks[l.current]-l.hooks[a]>l.width){l.set(a+2);break}if(0===a){l.set(0);break}}else l.set(l.current-g._options.carouselSteps)})},set:function(a){for(a=Math.max(a,0);l.hooks[a-1]+l.width>=l.max&&a>=0;)a--;l.current=a,l.animate()},getLast:function(a){return(a||l.current)-1},follow:function(a){if(0===a||a===l.hooks.length-2)return void l.set(a);for(var b=l.current;l.hooks[b]-l.hooks[l.current]<l.width&&b<=l.hooks.length;)b++;a-1<l.current?l.set(a-1):a+2>b&&l.set(a-b+l.current+2)},setClasses:function(){l.prev.toggleClass("disabled",!l.current),l.next.toggleClass("disabled",l.hooks[l.current]+l.width>=l.max)},animate:function(){l.setClasses();var a=-1*l.hooks[l.current];isNaN(a)||E.animate(g.get("thumbnails"),{left:a},{duration:g._options.carouselSpeed,easing:g._options.easing,queue:!1})}},m=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+g._id,swapTimer:"swap"+g._id,init:function(){m.initialized=!0;var a=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";E.insertStyleTag(a),g.$("tooltip").css("opacity",.8),E.hide(g.get("tooltip"))},move:function(a){var b=g.getMousePosition(a).x,c=g.getMousePosition(a).y,d=g.$("tooltip"),e=b,f=c,h=d.outerHeight(!0)+1,i=d.outerWidth(!0),j=h+15,k=g.$("container").width()-i-2,l=g.$("container").height()-h-2;isNaN(e)||isNaN(f)||(e+=10,f-=30,e=Math.max(0,Math.min(k,e)),f=Math.max(0,Math.min(l,f)),j>c&&(f=j),d.css({left:e,top:f}))},bind:function(b,c){if(!Galleria.TOUCH){m.initialized||m.init();var d=function(b,c){m.define(b,c),a(b).hover(function(){E.clearTimer(m.swapTimer),g.$("container").unbind("mousemove",m.move).bind("mousemove",m.move).trigger("mousemove"),m.show(b),E.addTimer(m.timer,function(){g.$("tooltip").stop().show().animate({opacity:1}),m.open=!0},m.open?0:500)},function(){g.$("container").unbind("mousemove",m.move),E.clearTimer(m.timer),g.$("tooltip").stop().animate({opacity:0},200,function(){g.$("tooltip").hide(),E.addTimer(m.swapTimer,function(){m.open=!1},1e3)})}).click(function(){a(this).trigger("mouseout")})};"string"==typeof c?d(b in g._dom?g.get(b):b,c):a.each(b,function(a,b){d(g.get(a),b)})}},show:function(b){b=a(b in g._dom?g.get(b):b);var d=b.data("tt"),e=function(a){c.setTimeout(function(a){return function(){m.move(a)}}(a),10),b.unbind("mouseup",e)};d="function"==typeof d?d():d,d&&(g.$("tooltip").html(d.replace(/\s/,"&nbsp;")),b.bind("mouseup",e))},define:function(b,c){if("function"!=typeof c){var d=c;c=function(){return d}}b=a(b in g._dom?g.get(b):b).data("tt",c),m.show(b)}},o=this._fullscreen={scrolled:0,crop:b,transition:b,active:!1,keymap:g._keyboard.map,os:{callback:n,support:function(){var a=q().html;return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullScreen}(),enter:function(a){o.os.callback=a||n;var b=q().html;b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen&&b.webkitRequestFullScreen()},exit:function(a){o.os.callback=a||n,d.exitFullscreen?d.exitFullscreen():d.mozCancelFullScreen?d.mozCancelFullScreen():d.webkitCancelFullScreen&&d.webkitCancelFullScreen()},listen:function(){if(o.os.support){var a=function(){d.fullscreen||d.mozFullScreen||d.webkitIsFullScreen?o._enter(o.os.callback):o._exit(o.os.callback)};d.addEventListener("fullscreenchange",a,!1),d.addEventListener("mozfullscreenchange",a,!1),d.addEventListener("webkitfullscreenchange",a,!1)}}},enter:function(a){g._options.trueFullscreen&&o.os.support?o.os.enter(a):o._enter(a)},_enter:function(c){o.active=!0,E.hide(g.getActiveImage()),g.$("container").addClass("fullscreen"),o.scrolled=f.scrollTop(),E.forceStyles(g.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var d={height:"100%",overflow:"hidden",margin:0,padding:0},e=g.getData(),h=g._options;if(E.forceStyles(q().html,d),E.forceStyles(q().body,d),o.keymap=a.extend({},g._keyboard.map),g.attachKeyboard({escape:g.exitFullscreen,right:g.next,left:g.prev}),o.crop=h.imageCrop,h.fullscreenCrop!=b&&(h.imageCrop=h.fullscreenCrop),e&&e.big&&e.image!==e.big){var i=new Galleria.Picture,j=i.isCached(e.big),k=g.getIndex(),l=g._thumbnails[k];g.trigger({type:Galleria.LOADSTART,cached:j,rewind:!1,index:k,imageTarget:g.getActiveImage(),thumbTarget:l,galleriaData:e}),i.load(e.big,function(b){g._scaleImage(b,{complete:function(b){g.trigger({type:Galleria.LOADFINISH,cached:j,index:k,rewind:!1,imageTarget:b.image,thumbTarget:l});var c=g._controls.getActive().image;c&&a(c).width(b.image.width).height(b.image.height).attr("style",a(b.image).attr("style")).attr("src",b.image.src)}})})}g.rescale(function(){E.addTimer(!1,function(){E.show(g.getActiveImage()),"function"==typeof c&&c.call(g)},100),g.trigger(Galleria.FULLSCREEN_ENTER)}),f.resize(function(){o.scale()})},scale:function(){g.rescale()},exit:function(a){g._options.trueFullscreen&&o.os.support?o.os.exit(a):o._exit(a)},_exit:function(a){o.active=!1,E.hide(g.getActiveImage()),g.$("container").removeClass("fullscreen"),E.revertStyles(g.get("container"),q().html,q().body),c.scrollTo(0,o.scrolled),g.detachKeyboard(),g.attachKeyboard(o.keymap),g._options.imageCrop=o.crop;var b=g.getData().big,d=g._controls.getActive().image;!g.getData().iframe&&d&&b&&b==d.src&&c.setTimeout(function(a){return function(){d.src=a}}(g.getData().image),1),g.rescale(function(){E.addTimer(!1,function(){E.show(g.getActiveImage()),"function"==typeof a&&a.call(g),f.trigger("resize")},50),g.trigger(Galleria.FULLSCREEN_EXIT)}),f.unbind("resize",o.scale)}};o.os.listen();var r=this._idle={timer:"idle"+g._id,trunk:[],bound:!1,add:function(b,c){if(b){r.bound||r.addEvent(),b=a(b);var d,e={};for(d in c)c.hasOwnProperty(d)&&(e[d]=b.css(d));b.data("idle",{from:e,to:c,complete:!0,busy:!1}),r.addTimer(),r.trunk.push(b)}},remove:function(b){b=jQuery(b),a.each(r.trunk,function(a,c){c&&c.length&&!c.not(b).length&&(g._idle.show(b),g._idle.trunk.splice(a,1))}),r.trunk.length||(r.removeEvent(),E.clearTimer(r.timer))},addEvent:function(){r.bound=!0,g.$("container").bind("mousemove click",r.showAll)},removeEvent:function(){r.bound=!1,g.$("container").unbind("mousemove click",r.showAll)},addTimer:function(){E.addTimer(r.timer,function(){r.hide()},g._options.idleTime)},hide:function(){g._options.idleMode&&g.getIndex()!==!1&&!g.getData().iframe&&(g.trigger(Galleria.IDLE_ENTER),a.each(r.trunk,function(a,b){var c=b.data("idle");c&&(b.data("idle").complete=!1,E.animate(b,c.to,{duration:g._options.idleSpeed}))}))},showAll:function(){E.clearTimer(r.timer),a.each(r.trunk,function(a,b){r.show(b)})},show:function(b){var c=b.data("idle");c.busy||c.complete||(c.busy=!0,g.trigger(Galleria.IDLE_EXIT),E.clearTimer(r.timer),E.animate(b,c.from,{duration:g._options.idleSpeed/2,complete:function(){a(this).data("idle").busy=!1,a(this).data("idle").complete=!0}})),r.addTimer()}},s=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(g.trigger(Galleria.LIGHTBOX_OPEN),!s.initialized){s.initialized=!0;var b="overlay box content shadow title info close prevholder prev nextholder next counter image",c={},d=g._options,e="",f="position:absolute;",h="lightbox-",i={overlay:"position:fixed;display:none;opacity:"+d.overlayOpacity+";filter:alpha(opacity="+100*d.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+d.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:f+"background:#000;width:100%;height:100%;",content:f+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:f+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:f+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:f+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:f+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:f+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:f+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:f+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},j=function(b){return b.hover(function(){a(this).css("color","#bbb")},function(){a(this).css("color","#444")})},k={};p&&p>7&&(i.nextholder+="background:#000;filter:alpha(opacity=0);",i.prevholder+="background:#000;filter:alpha(opacity=0);"),a.each(i,function(a,b){e+=".galleria-"+h+a+"{"+b+"}"}),e+=".galleria-"+h+"box.iframe .galleria-"+h+"prevholder,.galleria-"+h+"box.iframe .galleria-"+h+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}",E.insertStyleTag(e),a.each(b.split(" "),function(a,b){g.addElement("lightbox-"+b),c[b]=s.elems[b]=g.get("lightbox-"+b)
}),s.image=new Galleria.Picture,a.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(b,c){var d=[];a.each(c.split(" "),function(a,b){d.push(h+b)}),k[h+b]=d}),g.append(k),a(c.image).append(s.image.container),a(q().body).append(c.overlay,c.box),E.optimizeTouch(c.box),j(a(c.close).bind("click",s.hide).html("&#215;")),a.each(["Prev","Next"],function(b,d){var e=a(c[d.toLowerCase()]).html(/v/.test(d)?"&#8249;&nbsp;":"&nbsp;&#8250;"),f=a(c[d.toLowerCase()+"holder"]);return f.bind("click",function(){s["show"+d]()}),8>p||Galleria.TOUCH?void e.show():void f.hover(function(){e.show()},function(){e.stop().fadeOut(200)})}),a(c.overlay).bind("click",s.hide),Galleria.IPAD&&(g._options.lightboxTransitionSpeed=0)}},rescale:function(b){var c=Math.min(f.width()-40,s.width),d=Math.min(f.height()-60,s.height),e=Math.min(c/s.width,d/s.height),h=Math.round(s.width*e)+40,i=Math.round(s.height*e)+60,j={width:h,height:i,"margin-top":-1*Math.ceil(i/2),"margin-left":-1*Math.ceil(h/2)};b?a(s.elems.box).css(j):a(s.elems.box).animate(j,{duration:g._options.lightboxTransitionSpeed,easing:g._options.easing,complete:function(){var b=s.image,c=g._options.lightboxFadeSpeed;g.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:b.image}),a(b.container).show(),a(b.image).animate({opacity:1},c),E.show(s.elems.info,c)}})},hide:function(){s.image.image=null,f.unbind("resize",s.rescale),a(s.elems.box).hide(),E.hide(s.elems.info),g.detachKeyboard(),g.attachKeyboard(s.keymap),s.keymap=!1,E.hide(s.elems.overlay,200,function(){a(this).hide().css("opacity",g._options.overlayOpacity),g.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){s.show(g.getNext(s.active))},showPrev:function(){s.show(g.getPrev(s.active))},show:function(b){s.active=b="number"==typeof b?b:g.getIndex()||0,s.initialized||s.init(),s.keymap||(s.keymap=a.extend({},g._keyboard.map),g.attachKeyboard({escape:s.hide,right:s.showNext,left:s.showPrev})),f.unbind("resize",s.rescale);var d,e,h,i=g.getData(b),j=g.getDataLength(),k=g.getNext(b);E.hide(s.elems.info);try{for(h=g._options.preload;h>0;h--)e=new Galleria.Picture,d=g.getData(k),e.preload("big"in d?d.big:d.image),k=g.getNext(k)}catch(l){}s.image.isIframe=!!i.iframe,a(s.elems.box).toggleClass("iframe",!!i.iframe),s.image.load(i.iframe||i.big||i.image,function(d){s.width=d.isIframe?a(c).width():d.original.width,s.height=d.isIframe?a(c).height():d.original.height,a(d.image).css({width:d.isIframe?"100%":"100.1%",height:d.isIframe?"100%":"100.1%",top:0,zIndex:99998,opacity:0,visibility:"visible"}),s.elems.title.innerHTML=i.title||"",s.elems.counter.innerHTML=b+1+" / "+j,f.resize(s.rescale),s.rescale()}),a(s.elems.overlay).show().css("visibility","visible"),a(s.elems.box).show()}};return this},Galleria.prototype={constructor:Galleria,init:function(c,d){return d=t(d),this._original={target:c,options:d,data:null},this._target=this._dom.target=c.nodeName?c:a(c).get(0),this._original.html=this._target.innerHTML,z.push(this),this._target?(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(){return{}},dataSelector:"img",dataSource:this._target,debug:b,dummy:b,easing:"galleria",extend:function(){},fullscreenCrop:b,fullscreenDoubleTap:!0,fullscreenTransition:b,height:0,idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:b,initialTransition:b,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:b,minScaleRatio:b,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!1,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,touchTransition:b,transition:"fade",transitionInitial:b,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,d&&d.debug===!1&&(i=!1),d&&"number"==typeof d.imageTimeout&&(j=d.imageTimeout),d&&"string"==typeof d.dummy&&(k=d.dummy),a(this._target).children().hide(),"object"==typeof Galleria.theme?this._init():C.push(this),this):void Galleria.raise("Target not found",!0)},_init:function(){var b=this,e=this._options;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!Galleria.theme)return Galleria.raise("Init failed: No theme found.",!0),this;if(a.extend(!0,e,Galleria.theme.defaults,this._original.options,Galleria.configure.options),function(a){return"getContext"in a?void(B=B||{elem:a,context:a.getContext("2d"),cache:{},length:0}):void(a=null)}(d.createElement("canvas")),this.bind(Galleria.DATA,function(){Galleria.QUIRK&&Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML."),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var a=this.$("container"),d={width:0,height:0},e=function(){return b.$("stage").height()};E.wait({until:function(){return d=b._getWH(),a.width(d.width).height(d.height),e()&&d.width&&d.height>50},success:function(){b._width=d.width,b._height=d.height,Galleria.WEBKIT?c.setTimeout(function(){b._run()},1):b._run()},error:function(){e()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+d.width+"px, height: "+d.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+e()+"px.",!0)},timeout:"number"==typeof this._options.wait?this._options.wait:!1})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),E.hide(this.$("counter").append(this.get("current"),d.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),E.hide(b.get("tooltip")),this.$("container").addClass(Galleria.TOUCH?"touch":"notouch"),a.each(new Array(2),function(c){var d=new Galleria.Picture;a(d.container).css({position:"absolute",top:0,left:0}).prepend(b._layers[c]=a(E.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),b.$("images").append(d.container),b._controls[c]=d}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",function(a){e.clicknext&&a.stopPropagation(),e.pauseOnInteraction&&b.pause();var c=/right/.test(this.className)?"next":"prev";b[c]()}),a.each(["info","counter","image-nav"],function(a,c){e["show"+c.substr(0,1).toUpperCase()+c.substr(1).replace(/-/,"")]===!1&&E.moveOut(b.get(c.toLowerCase()))}),this.load(),e.keepSource||p||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),e.carousel){var g=0,h=e.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel(),++g==this.getDataLength()&&"number"==typeof h&&h>0&&this._carousel.follow(h)})}return e.responsive&&f.bind("resize",function(){b.isFullscreen()||b.resize()}),e.swipe&&(!function(a){var c,d=[0,0],e=[0,0],f=30,g=100,h=!1,i=0,j={start:"touchstart",move:"touchmove",stop:"touchend"},k=function(a){return a.originalEvent.touches?a.originalEvent.touches[0]:a},l=function(a){a.originalEvent.touches&&a.originalEvent.touches.length>1||(c=k(a),e=[c.pageX,c.pageY],d[0]||(d=e),Math.abs(d[0]-e[0])>10&&a.preventDefault())},m=function(c){return a.unbind(j.move,l),c.originalEvent.touches&&c.originalEvent.touches.length||h?void(h=!h):(E.timestamp()-i<1e3&&Math.abs(d[0]-e[0])>f&&Math.abs(d[1]-e[1])<g&&(c.preventDefault(),b[d[0]>e[0]?"next":"prev"]()),void(d=e=[0,0]))};a.bind(j.start,function(b){b.originalEvent.touches&&b.originalEvent.touches.length>1||(c=k(b),i=E.timestamp(),d=e=[c.pageX,c.pageY],a.bind(j.move,l).one(j.stop,m))})}(b.$("images")),e.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var a,c,d,e,f,g,h=function(a){return a.originalEvent.touches?a.originalEvent.touches[0]:a};return function(i){return g=Galleria.utils.timestamp(),c=h(i).pageX,d=h(i).pageY,500>g-a&&20>c-e&&20>d-f?(b.toggleFullscreen(),i.preventDefault(),void b.$("stage").unbind("touchend",arguments.callee)):(a=g,e=c,void(f=d))}}())),E.optimizeTouch(this.get("container")),a.each(Galleria.on.binds,function(a,c){b.bind(c.type,c.callback)}),this},_getWH:function(){var b,c=this.$("container"),d=this.$("target"),e=this,f={};return a.each(["width","height"],function(a,g){e._options[g]&&"number"==typeof e._options[g]?f[g]=e._options[g]:(b=[E.parseValue(c.css(g)),E.parseValue(d.css(g)),c[g](),d[g]()],e["_"+g]||b.splice(b.length,E.parseValue(c.css("min-"+g)),E.parseValue(d.css("min-"+g))),f[g]=Math.max.apply(Math,b))}),e._options.height&&e._options.height<2&&(f.height=f.width*e._options.height),f},_createThumbnails:function(){this.get("total").innerHTML=this.getDataLength();var b,e,f,g,h,i,j=this,k=this._options,l=function(){var a=j.$("thumbnails").find(".active");return a.length?a.find("img").attr("src"):!1}(),m="string"==typeof k.thumbnails?k.thumbnails.toLowerCase():null,n=function(a){return d.defaultView&&d.defaultView.getComputedStyle?d.defaultView.getComputedStyle(f.container,null)[a]:i.css(a)},o=function(b,c,d){return function(){a(d).append(b),j.trigger({type:Galleria.THUMBNAIL,thumbTarget:b,index:c,galleriaData:j.getData(c)})}},p=function(b){k.pauseOnInteraction&&j.pause();var c=a(b.currentTarget).data("index");j.getIndex()!==c&&j.show(c),b.preventDefault()},q=function(b){b.scale({width:b.data.width,height:b.data.height,crop:k.thumbCrop,margin:k.thumbMargin,canvas:k.useCanvas,complete:function(b){var c,d,e=["left","top"],f=["Width","Height"],g=j.getData(b.index),h=g.thumb.split(":");a.each(f,function(f,g){c=g.toLowerCase(),k.thumbCrop===!0&&k.thumbCrop!==c||!k.thumbFit||(d={},d[c]=b[c],a(b.container).css(d),d={},d[e[f]]=0,a(b.image).css(d)),b["outer"+g]=a(b.container)["outer"+g](!0)}),E.toggleQuality(b.image,k.thumbQuality===!0||"auto"===k.thumbQuality&&b.original.width<3*b.width),g.iframe&&2==h.length&&h[0]in v&&v[h[0]].getThumb(h[1],function(a){return function(b){a.src=b}}(b.image)),j.trigger({type:Galleria.THUMBNAIL,thumbTarget:b.image,index:b.data.order,galleriaData:j.getData(b.data.order)})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),b=0;this._data[b];b++)g=this._data[b],k.thumbnails===!0&&(g.thumb||g.image)?(f=new Galleria.Picture(b),f.index=b,e=g.thumb||g.image,this.$("thumbnails").append(f.container),i=a(f.container),f.data={width:E.parseValue(n("width")),height:E.parseValue(n("height")),order:b},i.css(k.thumbFit&&k.thumbCrop!==!0?{width:"auto",height:"auto"}:{width:f.data.width,height:f.data.height}),h=e.split(":"),2==h.length&&h[0]in v?f.load("data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",{height:f.data.height,width:1.25*f.data.height},q):f.load(e,q),"all"===k.preload&&f.preload(g.image)):g.iframe||"empty"===m||"numbers"===m?(f={container:E.create("galleria-image"),image:E.create("img","span"),ready:!0},"numbers"===m&&a(f.image).text(b+1),g.iframe&&a(f.image).addClass("iframe"),this.$("thumbnails").append(f.container),c.setTimeout(o(f.image,b,f.container),50+20*b)):f={container:null,image:null},a(f.container).add(k.keepSource&&k.linkSourceImages?g.original:null).data("index",b).bind(k.thumbEventType,p),l===e&&a(f.container).addClass("active"),this._thumbnails.push(f)},_run:function(){var d=this;d._createThumbnails(),E.wait({timeout:1e4,until:function(){return Galleria.OPERA&&d.$("stage").css("display","inline-block"),d._stageWidth=d.$("stage").width(),d._stageHeight=d.$("stage").height(),d._stageWidth&&d._stageHeight>50},success:function(){return y.push(d),E.show(d.get("counter")),d._options.carousel&&d._carousel.bindControls(),d._options.autoplay&&(d.pause(),"number"==typeof d._options.autoplay&&(d._playtime=d._options.autoplay),d.trigger(Galleria.PLAY),d._playing=!0),d._firstrun?void("number"==typeof d._options.show&&d.show(d._options.show)):(d._firstrun=!0,Galleria.History&&Galleria.History.change(function(a){isNaN(a)?c.history.go(-1):d.show(a,b,!0)}),d.trigger(Galleria.READY),Galleria.theme.init.call(d,d._options),a.each(Galleria.ready.callbacks,function(){this.call(d,d._options)}),d._options.extend.call(d,d._options),void(/^[0-9]{1,4}$/.test(m)&&Galleria.History?d.show(m,b,!0):d._data[d._options.show]&&d.show(d._options.show)))},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+d._stageWidth+"px, height: "+d._stageHeight+"px.",!0)}})},load:function(b,c,d){var e=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof c&&(d=c,c=null),b=b||this._options.dataSource,c=c||this._options.dataSelector,d=d||this._options.dataConfig,/^function Object/.test(b.constructor)&&(b=[b]),b.constructor===Array?(this.validate(b)?(this._data=b,this._parseData().trigger(Galleria.DATA)):Galleria.raise("Load failed: JSON Array not valid."),this):(c+=",.video,.iframe",a(b).find(c).each(function(b,c){c=a(c);var f={},g=c.parent(),h=g.attr("href"),i=g.attr("rel");h&&("IMG"==c[0].nodeName||c.hasClass("video"))&&w(h)?f.video=h:h&&c.hasClass("iframe")?f.iframe=h:f.image=f.big=h,i&&(f.big=i),a.each("big title description link layer".split(" "),function(a,b){c.data(b)&&(f[b]=c.data(b))}),e._data.push(a.extend({title:c.attr("title")||"",thumb:c.attr("src"),image:c.attr("src"),big:c.attr("src"),description:c.attr("alt")||"",link:c.attr("longdesc"),original:c.get(0)},f,d(c)))}),this.getDataLength()?this._parseData().trigger(Galleria.DATA):Galleria.raise("Load failed: no data found."),this)},_parseData:function(){var b,c=this;return a.each(this._data,function(d,e){if(b=c._data[d],"thumb"in e==!1&&(b.thumb=e.image),!1 in e&&(b.big=e.image),"video"in e){var f=w(e.video);f&&(b.iframe=v[f.provider].embed(f.id)+function(){if("object"==typeof c._options[f.provider]){var b="?",d=[];return a.each(c._options[f.provider],function(a,b){d.push(a+"="+b)}),"youtube"==f.provider&&(d=["wmode=opaque"].concat(d)),b+d.join("&")}return""}(),delete b.video,"thumb"in b&&b.thumb||(b.thumb=f.provider+":"+f.id))}}),this},destroy:function(){return this.get("target").innerHTML=this._original.html,this},splice:function(){var a=this,b=E.array(arguments);return c.setTimeout(function(){g.splice.apply(a._data,b),a._parseData()._createThumbnails()},2),a},push:function(){var a=this,b=E.array(arguments);return c.setTimeout(function(){g.push.apply(a._data,b),a._parseData()._createThumbnails()},2),a},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(a,b){return a=u(a),this.$("container").bind(a,this.proxy(b)),this},unbind:function(a){return a=u(a),this.$("container").unbind(a),this},trigger:function(b){return b="object"==typeof b?a.extend(b,{scope:this}):{type:u(b),scope:this},this.$("container").trigger(b),this},addIdleState:function(){return this._idle.add.apply(this._idle,E.array(arguments)),this},removeIdleState:function(){return this._idle.remove.apply(this._idle,E.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(){return this._fullscreen.enter.apply(this,E.array(arguments)),this},exitFullscreen:function(){return this._fullscreen.exit.apply(this,E.array(arguments)),this},toggleFullscreen:function(){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,E.array(arguments)),this},bindTooltip:function(){return this._tooltip.bind.apply(this._tooltip,E.array(arguments)),this},defineTooltip:function(){return this._tooltip.define.apply(this._tooltip,E.array(arguments)),this},refreshTooltip:function(){return this._tooltip.show.apply(this._tooltip,E.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,E.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,E.array(arguments)),this},getActiveImage:function(){return this._getActive().image||b},getActiveThumb:function(){return this._thumbnails[this._active].image||b},getMousePosition:function(a){return{x:a.pageX-this.$("container").offset().left,y:a.pageY-this.$("container").offset().top}},addPan:function(b){if(this._options.imageCrop!==!1){b=a(b||this.getActiveImage());var c=this,d=b.width()/2,e=b.height()/2,f=parseInt(b.css("left"),10),g=parseInt(b.css("top"),10),h=f||0,i=g||0,j=0,k=0,l=!1,m=E.timestamp(),n=0,o=0,q=function(a,c,d){if(a>0&&(o=Math.round(Math.max(-1*a,Math.min(0,c))),n!==o))if(n=o,8===p)b.parent()["scroll"+d](-1*o);else{var e={};e[d.toLowerCase()]=o,b.css(e)}},r=function(a){E.timestamp()-m<50||(l=!0,d=c.getMousePosition(a).x,e=c.getMousePosition(a).y)},s=function(){l&&(j=b.width()-c._stageWidth,k=b.height()-c._stageHeight,f=d/c._stageWidth*j*-1,g=e/c._stageHeight*k*-1,h+=(f-h)/c._options.imagePanSmoothness,i+=(g-i)/c._options.imagePanSmoothness,q(k,i,"Top"),q(j,h,"Left"))};return 8===p&&(b.parent().scrollTop(-1*i).scrollLeft(-1*h),b.css({top:0,left:0})),this.$("stage").unbind("mousemove",r).bind("mousemove",r),E.addTimer("pan"+c._id,s,50,!0),this}},proxy:function(a,b){return"function"!=typeof a?n:(b=b||this,function(){return a.apply(b,E.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),E.clearTimer("pan"+this._id),this},addElement:function(){var b=this._dom;return a.each(E.array(arguments),function(a,c){b[c]=E.create("galleria-"+c)}),this},attachKeyboard:function(){return this._keyboard.attach.apply(this._keyboard,E.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,E.array(arguments)),this},appendChild:function(a,b){return this.$(a).append(this.get(b)||b),this},prependChild:function(a,b){return this.$(a).prepend(this.get(b)||b),this},remove:function(){return this.$(E.array(arguments).join(",")).remove(),this},append:function(a){var b,c;for(b in a)if(a.hasOwnProperty(b))if(a[b].constructor===Array)for(c=0;a[b][c];c++)this.appendChild(b,a[b][c]);else this.appendChild(b,a[b]);return this},_scaleImage:function(b,c){if(b=b||this._controls.getActive()){var d,e=function(b){a(b.container).children(":first").css({top:Math.max(0,E.parseValue(b.image.style.top)),left:Math.max(0,E.parseValue(b.image.style.left)),width:E.parseValue(b.image.width),height:E.parseValue(b.image.height)})};return c=a.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},c),this._options.layerFollow&&this._options.imageCrop!==!0?"function"==typeof c.complete?(d=c.complete,c.complete=function(){d.call(b,b),e(b)}):c.complete=e:a(b.container).children(":first").css({top:0,left:0}),b.scale(c),this}},updateCarousel:function(){return this._carousel.update(),this},resize:function(c,d){"function"==typeof c&&(d=c,c=b),c=a.extend({width:0,height:0},c);var e,f=this,g=this.$("container"),h=!("aspect"!=this._options.responsive||c.width&&c.height);return a.each(c,function(a,b){b||(g[a]("auto"),c[a]=f._getWH()[a])}),h&&(e=Math.min(c.width/this._width,c.height/this._height)),a.each(c,function(a,b){g[a](e?e*f["_"+a]:b)}),this.rescale(d)},rescale:function(a,c,d){var e=this;"function"==typeof a&&(d=a,a=b);var f=function(){e._stageWidth=a||e.$("stage").width(),e._stageHeight=c||e.$("stage").height(),e._scaleImage(),e._options.carousel&&e.updateCarousel(),e.trigger(Galleria.RESCALE),"function"==typeof d&&d.call(e)};return!Galleria.WEBKIT||Galleria.TOUCH||a||c?f.call(e):E.addTimer(!1,f,10),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(a,b,c){return a===!1||!this._options.queue&&this._queue.stalled?void 0:(a=Math.max(0,Math.min(parseInt(a,10),this.getDataLength()-1)),b="undefined"!=typeof b?!!b:a<this.getIndex(),c=c||!1,!c&&Galleria.History?void Galleria.History.set(a.toString()):(this._active=a,g.push.call(this._queue,{index:a,rewind:b}),this._queue.stalled||this._show(),this))},_show:function(){var d=this,e=this._queue[0],f=this.getData(e.index);if(f){var h=f.iframe||(this.isFullscreen()&&"big"in f?f.big:f.image),i=this._controls.getActive(),j=this._controls.getNext(),k=j.isCached(h),l=this._thumbnails[e.index],m=function(){a(j.image).trigger("mouseup")},n=function(b,e,f,h,i){return function(){var j;d._queue.stalled=!1,E.toggleQuality(e.image,d._options.imageQuality),d._layers[d._controls.active].innerHTML="",a(f.container).css({zIndex:0,opacity:0}).show(),f.isIframe&&a(f.container).find("iframe").remove(),d.$("container").toggleClass("iframe",!!b.iframe),a(e.container).css({zIndex:1,left:0,top:0}).show(),d._controls.swap(),d._options.imagePan&&d.addPan(e.image),(b.link||d._options.lightbox||d._options.clicknext)&&a(e.image).css({cursor:"pointer"}).bind("mouseup",function(){return d._options.clicknext&&!Galleria.TOUCH?(d._options.pauseOnInteraction&&d.pause(),void d.next()):b.link?void(d._options.popupLinks?j=c.open(b.link,"_blank"):c.location.href=b.link):void(d._options.lightbox&&d.openLightbox())}),g.shift.call(d._queue),d._queue.length&&d._show(),d._playCheck(),d.trigger({type:Galleria.IMAGE,index:h.index,imageTarget:e.image,thumbTarget:i.image,galleriaData:b})}}(f,j,i,e,l);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(e.index),this._options.preload){var o,p,q,r=this.getNext();try{for(p=this._options.preload;p>0;p--)o=new Galleria.Picture,q=d.getData(r),o.preload(this.isFullscreen()&&"big"in q?q.big:q.image),r=d.getNext(r)}catch(s){}}E.show(j.container),j.isIframe=!!f.iframe,a(d._thumbnails[e.index].container).addClass("active").siblings(".active").removeClass("active"),d.trigger({type:Galleria.LOADSTART,cached:k,index:e.index,rewind:e.rewind,imageTarget:j.image,thumbTarget:l.image,galleriaData:f}),j.load(h,function(c){var g=a(d._layers[1-d._controls.active]).html(f.layer||"").hide();d._scaleImage(c,{complete:function(c){"image"in i&&E.toggleQuality(i.image,!1),E.toggleQuality(c.image,!1),d._queue.stalled=!0,d.removePan(),d.setInfo(e.index),d.setCounter(e.index),f.layer&&(g.show(),(f.link||d._options.lightbox||d._options.clicknext)&&g.css("cursor","pointer").unbind("mouseup").mouseup(m)),d.trigger({type:Galleria.LOADFINISH,cached:k,index:e.index,rewind:e.rewind,imageTarget:c.image,thumbTarget:d._thumbnails[e.index].image,galleriaData:d.getData(e.index)});var h=d._options.transition;if(a.each({initial:null===i.image,touch:Galleria.TOUCH,fullscreen:d.isFullscreen()},function(a,c){return c&&d._options[a+"Transition"]!==b?(h=d._options[a+"Transition"],!1):void 0}),h in F==!1)n();else{var j={prev:i.container,next:c.container,rewind:e.rewind,speed:d._options.transitionSpeed||400};F[h].call(d,j,n)}}})})}},getNext:function(a){return a="number"==typeof a?a:this.getIndex(),a===this.getDataLength()-1?0:a+1},getPrev:function(a){return a="number"==typeof a?a:this.getIndex(),0===a?this.getDataLength()-1:a-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(a){return a in this._dom?this._dom[a]:null},getData:function(a){return a in this._data?this._data[a]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active?this._active:!1},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(a){return"undefined"==typeof a?this._options:this._options[a]},setOptions:function(b,c){return"object"==typeof b?a.extend(this._options,b):this._options[b]=c,this},play:function(a){return this._playing=!0,this._playtime=a||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(a){return this._playing?this.pause():this.play(a)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var a=this,b=0,c=20,d=E.timestamp(),e="play"+this._id;if(this._playing){E.clearTimer(e);var f=function(){return b=E.timestamp()-d,b>=a._playtime&&a._playing?(E.clearTimer(e),void a.next()):void(a._playing&&(a.trigger({type:Galleria.PROGRESS,percent:Math.ceil(b/a._playtime*100),seconds:Math.floor(b/1e3),milliseconds:b}),E.addTimer(e,f,c)))};E.addTimer(e,f,c)}},setPlaytime:function(a){return this._playtime=a,this},setIndex:function(a){return this._active=a,this},setCounter:function(a){if("number"==typeof a?a++:"undefined"==typeof a&&(a=this.getIndex()+1),this.get("current").innerHTML=a,p){var b=this.$("counter"),c=b.css("opacity");1===parseInt(c,10)?E.removeAlpha(b[0]):this.$("counter").css("opacity",c)}return this},setInfo:function(b){var c=this,d=this.getData(b);return a.each(["title","description"],function(a,b){var e=c.$("info-"+b);d[b]?e[d[b].length?"show":"hide"]().html(d[b]):e.empty().hide()}),this},hasInfo:function(a){var b,c="title description".split(" ");for(b=0;c[b];b++)if(this.getData(a)[c[b]])return!0;return!1},jQuery:function(b){var c=this,d=[];a.each(b.split(","),function(b,e){e=a.trim(e),c.get(e)&&d.push(e)});var e=a(c.get(d.shift()));return a.each(d,function(a,b){e=e.add(c.get(b))}),e},$:function(){return this.jQuery.apply(this,E.array(arguments))}},a.each(s,function(a,b){var c=/_/.test(b)?b.replace(/_/g,""):b;Galleria[b.toUpperCase()]="galleria."+c}),a.extend(Galleria,{IE9:9===p,IE8:8===p,IE7:7===p,IE6:6===p,IE:p,WEBKIT:/webkit/.test(l),CHROME:/chrome/.test(l),SAFARI:/safari/.test(l)&&!/chrome/.test(l),QUIRK:p&&d.compatMode&&"BackCompat"===d.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!c.opera,IPHONE:/iphone/.test(l),IPAD:/ipad/.test(l),ANDROID:/android/.test(l),TOUCH:"ontouchstart"in d}),Galleria.addTheme=function(b){b.name||Galleria.raise("No theme name specified"),b.defaults="object"!=typeof b.defaults?{}:t(b.defaults);var c,d=!1;return"string"==typeof b.css?(a("link").each(function(a,e){return c=new RegExp(b.css),c.test(e.href)?(d=!0,D(b),!1):void 0}),d||a("script").each(function(a,e){c=new RegExp("galleria\\."+b.name.toLowerCase()+"\\."),c.test(e.src)&&(d=e.src.replace(/[^\/]*$/,"")+b.css,E.addTimer("css",function(){E.loadCSS(d,"galleria-theme",function(){D(b)})},1))}),d||Galleria.raise("No theme CSS loaded")):D(b),b},Galleria.loadTheme=function(d,e){var f=y.length,g=c.setTimeout(function(){Galleria.raise("Theme at "+d+" could not load, check theme path.",!0)},5e3);return Galleria.theme=b,E.loadScript(d,function(){if(c.clearTimeout(g),f){var b=[];a.each(Galleria.get(),function(c,d){var f=a.extend(d._original.options,{data_source:d._data},e);d.$("container").remove();var g=new Galleria;g._id=d._id,g.init(d._original.target,f),b.push(g)}),y=b}}),Galleria},Galleria.get=function(a){return z[a]?z[a]:"number"!=typeof a?z:void Galleria.raise("Gallery index "+a+" not found")},Galleria.configure=function(b,c){var d={};return"string"==typeof b&&c?(d[b]=c,b=d):a.extend(d,b),Galleria.configure.options=d,a.each(Galleria.get(),function(a,b){b.setOptions(d)}),Galleria},Galleria.configure.options={},Galleria.on=function(b,c){return b?(Galleria.on.binds.push({type:b,callback:c||n}),a.each(Galleria.get(),function(a,d){d.bind(b,c)}),Galleria):void 0},Galleria.on.binds=[],Galleria.run=function(b,c){return a(b||"#galleria").galleria(c),Galleria},Galleria.addTransition=function(a,b){return F[a]=b,Galleria},Galleria.utils=E,Galleria.log=function(){return"console"in c&&"log"in c.console?c.console.log:function(){c.alert(E.array(arguments).join(", "))}}(),Galleria.ready=function(b){return a.each(y,function(a,c){b.call(c,c._options)}),Galleria.ready.callbacks.push(b),Galleria},Galleria.ready.callbacks=[],Galleria.raise=function(b,c){var d=c?"Fatal error":"Error",e={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},f=function(b){var f='<div style="padding:4px;margin:0 0 2px;background:#'+(c?"811":"222")+'";>'+(c?"<strong>"+d+": </strong>":"")+b+"</div>";a.each(z,function(){var a=this.$("errors"),b=this.$("target");a.length||(b.css("position","relative"),a=this.addElement("errors").appendChild("target","errors").$("errors").css(e)),a.append(f)}),z.length||a("<div>").css(a.extend(e,{position:"fixed"})).append(f).appendTo(q().body)};if(i){if(f(b),c)throw new Error(d+": "+b)}else if(c){if(A)return;A=!0,c=!1,f("Gallery could not load.")}},Galleria.version=h,Galleria.requires=function(a,b){return b=b||"You need to upgrade Galleria to version "+a+" to use one or more components.",Galleria.version<a&&Galleria.raise(b,!0),Galleria},Galleria.Picture=function(b){this.id=b||null,this.image=null,this.container=E.create("galleria-image"),a(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.isIframe=!1},Galleria.Picture.prototype={cache:{},show:function(){E.show(this.image)},hide:function(){E.moveOut(this.image)},clear:function(){this.image=null},isCached:function(a){return!!this.cache[a]},preload:function(b){a(new Image).load(function(a,b){return function(){b[a]=a}}(b,this.cache)).attr("src",b)},load:function(b,d,e){if("function"==typeof d&&(e=d,d=null),this.isIframe){var f="if"+(new Date).getTime();return this.image=a("<iframe>",{src:b,frameborder:0,id:f,allowfullscreen:!0,css:{visibility:"hidden"}})[0],a(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),a("#"+f).load(function(b,d){return function(){c.setTimeout(function(){a(b.image).css("visibility","visible"),"function"==typeof d&&d.call(b,b)},10)}}(this,e)),this.container}this.image=new Image;var g=!1,h=!1,i=a(this.container),j=a(this.image),l=function(b,e,f){return function(){var g=function(){a(this).unbind("load"),b.original=d||{height:this.height,width:this.width},b.container.appendChild(this),b.cache[f]=f,"function"==typeof e&&c.setTimeout(function(){e.call(b,b)},1)};this.width&&this.height?g.call(this):c.setTimeout(function(b){return function(){b.width&&b.height?g.call(b):h?Galleria.raise("Could not extract width/height from image: "+b.src+". Traced measures: width:"+b.width+"px, height: "+b.height+"px."):(a(new Image).load(l).attr("src",b.src),h=!0)}}(this),2)}}(this,e,b);return i.find("iframe,img").remove(),j.css("display","block"),E.hide(this.image),a.each("minWidth minHeight maxWidth maxHeight".split(" "),function(a,b){j.css(b,/min/.test(b)?"0":"none")}),this.cache[b]?(j.load(l).attr("src",b),this.container):(j.load(l).error(function(){g?k?a(this).attr("src",k):Galleria.raise("Image not found: "+b):(g=!0,c.setTimeout(function(a,b){return function(){a.attr("src",b+"?"+E.timestamp())}}(a(this),b),50))}).attr("src",b),this.container)},scale:function(c){var d=this;if(c=a.extend({width:0,height:0,min:b,max:b,margin:0,complete:n,position:"center",crop:!1,canvas:!1},c),this.isIframe){a(this.image).width(c.width).height(c.height).removeAttr("width").removeAttr("height"),a(this.container).width(c.width).height(c.height),c.complete.call(d,d);try{this.image.contentWindow&&a(this.image.contentWindow).trigger("resize")}catch(e){}return this.container}if(!this.image)return this.container;var f,g,h,i=a(d.container);return E.wait({until:function(){return f=c.width||i.width()||E.parseValue(i.css("width")),g=c.height||i.height()||E.parseValue(i.css("height")),f&&g
},success:function(){var b=(f-2*c.margin)/d.original.width,e=(g-2*c.margin)/d.original.height,i=Math.min(b,e),j=Math.max(b,e),k={"true":j,width:b,height:e,"false":i,landscape:d.original.width>d.original.height?j:i,portrait:d.original.width<d.original.height?j:i},l=k[c.crop.toString()],m="";c.max&&(l=Math.min(c.max,l)),c.min&&(l=Math.max(c.min,l)),a.each(["width","height"],function(b,c){a(d.image)[c](d[c]=d.image[c]=Math.round(d.original[c]*l))}),a(d.container).width(f).height(g),c.canvas&&B&&(B.elem.width=d.width,B.elem.height=d.height,m=d.image.src+":"+d.width+"x"+d.height,d.image.src=B.cache[m]||function(a){B.context.drawImage(d.image,0,0,d.original.width*l,d.original.height*l);try{return h=B.elem.toDataURL(),B.length+=h.length,B.cache[a]=h,h}catch(b){return d.image.src}}(m));var n={},o={},p=function(b,c,e){var f=0;if(/\%/.test(b)){var g=parseInt(b,10)/100,h=d.image[c]||a(d.image)[c]();f=Math.ceil(-1*h*g+e*g)}else f=E.parseValue(b);return f},q={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};a.each(c.position.toLowerCase().split(" "),function(a,b){"center"===b&&(b="50%"),n[a?"top":"left"]=b}),a.each(n,function(b,c){q.hasOwnProperty(c)&&a.extend(o,q[c])}),n=n.top?a.extend(n,o):o,n=a.extend({top:"50%",left:"50%"},n),a(d.image).css({position:"absolute",top:p(n.top,"height",g),left:p(n.left,"width",f)}),d.show(),d.ready=!0,c.complete.call(d,d)},error:function(){Galleria.raise("Could not scale image: "+d.image.src)},timeout:1e3}),this}},a.extend(a.easing,{galleria:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},galleriaIn:function(a,b,c,d,e){return d*(b/=e)*b+c},galleriaOut:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}}),a.fn.galleria=function(b){var c=this.selector;return a(this).length?this.each(function(){a.data(this,"galleria")||a.data(this,"galleria",(new Galleria).init(this,b))}):(a(function(){a(c).length?a(c).galleria(b):Galleria.utils.wait({until:function(){return a(c).length},success:function(){a(c).galleria(b)},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+c+'".')},timeout:5e3})}),this)}}(jQuery);var fadeSlideShow_descpanel={controls:[["/images/component/image_gallery/x.png",7,7],["/images/component/image_gallery/restore.png",10,11],["/images/component/image_gallery/loading.gif",54,55]],fontStyle:"normal 11px Verdana",slidespeed:200};fadeSlideShow.prototype={navigate:function(a){var b=this.setting;clearTimeout(b.playtimer),"auto"==b.displaymode.type&&(b.displaymode.type="manual",b.displaymode.wraparound=!0),isNaN(parseInt(a,10))?/(prev)|(next)/i.test(a)&&this.showslide(a.toLowerCase()):this.showslide(parseInt(a,10))},showslide:function(a){var b=this,c=b.setting;if("auto"==c.displaymode.type&&c.ismouseover&&c.currentstep<=c.totalsteps)return void(c.playtimer=setTimeout(function(){b.showslide("next")},c.displaymode.pause));var d=c.imagearray.length,e="next"==a?c.curimage<d-1?c.curimage+1:0:"prev"==a?c.curimage>0?c.curimage-1:d-1:Math.min(a,d-1),f=c.$gallerylayers.eq(c.bglayer).find("img").hide().eq(e).show(),g=[f.width(),f.height()];f.css({marginLeft:g[0]>0&&g[0]<c.dimensions[0]?c.dimensions[0]/2-g[0]/2:0}),f.css({marginTop:g[1]>0&&g[1]<c.dimensions[1]?c.dimensions[1]/2-g[1]/2:0}),c.$gallerylayers.eq(c.bglayer).css({zIndex:300,opacity:0}).stop().css({opacity:0}).animate({opacity:1},c.fadeduration,function(){clearTimeout(c.playtimer);try{c.onslide.call(b,c.$gallerylayers.eq(c.fglayer).get(0),c.curimage)}catch(a){alert('Fade In Slideshow error: An error has occured somwhere in your code attached to the "onslide" event: '+a)}c.currentstep+=1,"auto"==c.displaymode.type&&(c.currentstep<=c.totalsteps||0===c.displaymode.cycles)&&(c.playtimer=setTimeout(function(){b.showslide("next")},c.displaymode.pause))}),c.$gallerylayers.eq(c.fglayer).css({zIndex:299}),c.fglayer=c.bglayer,c.bglayer=0===c.bglayer?1:0,c.curimage=e,c.$descpanel&&c.$descpanel.css({visibility:c.imagearray[e][3]?"visible":"hidden"}),c.imagearray[e][3]&&c.$descinner.empty().html(c.closebutton+c.imagearray[e][3]),"manual"!=c.displaymode.type||c.displaymode.wraparound||this.paginatecontrol(),c.$status&&c.$status.html(c.curimage+1+"/"+d),c.$links&&jQuery(".fss_links a").each(function(a,b){a==c.curimage?jQuery(b).addClass("active"):jQuery(b).removeClass("active")})},showhidedescpanel:function(a){var b=this.setting,c="show"==a?b.dimensions[1]-b.panelheight:this.setting.dimensions[1];b.$descpanel.stop().animate({top:c},fadeSlideShow_descpanel.slidespeed,function(){"always"==b.descreveal&&"hide"==a&&b.$restorebutton.css({visibility:"visible"})})},paginateinit:function(b){var c=this,d=this.setting;if(d.togglerid&&(d.$togglerdiv=b("#"+d.togglerid),d.$prev=d.$togglerdiv.find(".prev").data("action","prev"),d.$next=d.$togglerdiv.find(".next").data("action","next"),d.$prev.add(d.$next).click(function(a){var d=b(this);c.navigate(d.data("action")),a.preventDefault()}),d.$status=d.$togglerdiv.find(".status"),d.$links=d.$togglerdiv.find(".fss_links"),d.$links))for(totalimages=d.imagearray.length,i=1;totalimages>=i;i++)a=jQuery('<a href="#'+i+'">'+i+"</a>"),a.click(function(a){n=jQuery(a.delegateTarget).html(),c.navigate(parseInt(n)-1),a.preventDefault()}),a.appendTo(d.$links)},paginatecontrol:function(){var a=this.setting;a.$prev.css({opacity:0===a.curimage?.4:1}).data("action",0===a.curimage?"none":"prev"),a.$next.css({opacity:a.curimage==a.imagearray.length-1?.4:1}).data("action",a.curimage==a.imagearray.length-1?"none":"next"),8==document.documentMode&&(a.$prev.find("img:eq(0)").css({opacity:0===a.curimage?.4:1}),a.$next.find("img:eq(0)").css({opacity:a.curimage==a.imagearray.length-1?.4:1}))}},fadeSlideShow.routines={getSlideHTML:function(a){var b=a[1]?'<a href="'+a[1]+'" target="'+a[2]+'">\n':"";return b+='<img src="'+a[0]+'" style="border-width:0;" />\n',b+=a[1]?"</a>\n":""},getFullHTML:function(a){for(var b="",c=0;c<a.length;c++)b+=this.getSlideHTML(a[c]);return b},adddescpanel:function(a,b){b.$descpanel=a('<div class="fadeslidedescdiv"></div>').css({position:"absolute",visibility:"hidden",width:"100%",left:0,top:b.dimensions[1],font:fadeSlideShow_descpanel.fontStyle,zIndex:"301"}).appendTo(b.$wrapperdiv),a('<div class="descpanelbg"></div><div class="descpanelfg"></div>').css({position:"absolute",left:0,top:0,width:b.$descpanel.width()-8,padding:"4px"}).eq(0).css({background:"black",opacity:.7}).end().eq(1).css({color:"white"}).html(b.closebutton+b.longestdesc).end().appendTo(b.$descpanel),b.$descinner=b.$descpanel.find("div.descpanelfg"),b.panelheight=b.$descinner.outerHeight(),b.$descpanel.css({height:b.panelheight}).find("div").css({height:"100%"}),"always"==b.descreveal&&(b.$restorebutton=a('<img class="restore" title="Restore Description" src="'+fadeSlideShow_descpanel.controls[1][0]+'" style="position:absolute;visibility:hidden;right:0;bottom:0;z-index:1002;width:'+fadeSlideShow_descpanel.controls[1][1]+"px;height:"+fadeSlideShow_descpanel.controls[1][2]+'px;cursor:pointer;cursor:hand" />').appendTo(b.$wrapperdiv))},getCookie:function(a){var b=new RegExp(a+"=[^;]+","i");return document.cookie.match(b)?document.cookie.match(b)[0].split("=")[1]:null},setCookie:function(a,b){document.cookie=a+"="+b+";path=/"}},function(a,b,c){function d(a){return a}function e(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g,g=a.cookie=function(f,h,i){if(h!==c){if(i=a.extend({},g.defaults,i),null===h&&(i.expires=-1),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setDate(k.getDate()+j)}return h=g.json?JSON.stringify(h):String(h),b.cookie=[encodeURIComponent(f),"=",g.raw?h:encodeURIComponent(h),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=g.raw?d:e,m=b.cookie.split("; "),n=0,o=m.length;o>n;n++){var p=m[n].split("=");if(l(p.shift())===f){var q=l(p.join("="));return g.json?JSON.parse(q):q}}return null};g.defaults={},a.removeCookie=function(b,c){return null!==a.cookie(b)?(a.cookie(b,null,c),!0):!1}}($j,document),!function(a,b){"use strict";var c,d=a.document,e=d.documentElement,f=a.Modernizr,g=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},h="Moz Webkit O Ms".split(" "),i=function(a){var b,c=e.style;if("string"==typeof c[a])return a;a=g(a);for(var d=0,f=h.length;f>d;d++)if(b=h[d]+a,"string"==typeof c[b])return b},j=i("transform"),k=i("transitionProperty"),l={csstransforms:function(){return!!j},csstransforms3d:function(){var a=!!i("perspective");if(a&&"webkitPerspective"in e.style){var c=b("<style>@media (transform-3d),(-webkit-transform-3d){#modernizr{height:3px}}</style>").appendTo("head"),d=b('<div id="modernizr" />').appendTo("html");a=3===d.height(),d.remove(),c.remove()}return a},csstransitions:function(){return!!k}};if(f)for(c in l)f.hasOwnProperty(c)||f.addTest(c,l[c]);else{f=a.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var m,n=" ";for(c in l)m=l[c](),f[c]=m,n+=" "+(m?"":"no-")+c;b("html").addClass(n)}if(f.csstransforms){var o=f.csstransforms3d?{translate:function(a){return"translate3d("+a[0]+"px, "+a[1]+"px, 0) "},scale:function(a){return"scale3d("+a+", "+a+", 1) "}}:{translate:function(a){return"translate("+a[0]+"px, "+a[1]+"px) "},scale:function(a){return"scale("+a+") "}},p=function(a,c,d){var e,f,g=b.data(a,"isoTransform")||{},h={},i={};h[c]=d,b.extend(g,h);for(e in g)f=g[e],i[e]=o[e](f);var k=i.translate||"",l=i.scale||"",m=k+l;b.data(a,"isoTransform",g),a.style[j]=m};b.cssNumber.scale=!0,b.cssHooks.scale={set:function(a,b){p(a,"scale",b)},get:function(a){var c=b.data(a,"isoTransform");return c&&c.scale?c.scale:1}},b.fx.step.scale=function(a){b.cssHooks.scale.set(a.elem,a.now+a.unit)},b.cssNumber.translate=!0,b.cssHooks.translate={set:function(a,b){p(a,"translate",b)},get:function(a){var c=b.data(a,"isoTransform");return c&&c.translate?c.translate:[0,0]}}}var q,r;f.csstransitions&&(q={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[k],r=i("transitionDuration"));var s,t=b.event,u=b.event.handle?"handle":"dispatch";t.special.smartresize={setup:function(){b(this).bind("resize",t.special.smartresize.handler)},teardown:function(){b(this).unbind("resize",t.special.smartresize.handler)},handler:function(a,b){var c=this,d=arguments;a.type="smartresize",s&&clearTimeout(s),s=setTimeout(function(){t[u].apply(c,d)},"execAsap"===b?0:100)}},b.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])},b.Isotope=function(a,c,d){this.element=b(c),this._create(a),this._init(d)};var v=["width","height"],w=b(a);b.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},b.Isotope.prototype={_create:function(a){this.options=b.extend({},b.Isotope.settings,a),this.styleQueue=[],this.elemCount=0;var c=this.element[0].style;this.originalStyle={};var d=v.slice(0);for(var e in this.options.containerStyle)d.push(e);for(var f=0,g=d.length;g>f;f++)e=d[f],this.originalStyle[e]=c[e]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var h={"original-order":function(a,b){return b.elemCount++,b.elemCount},random:function(){return Math.random()}};this.options.getSortData=b.extend(this.options.getSortData,h),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var i=this;setTimeout(function(){i.element.addClass(i.options.containerClass)},0),this.options.resizable&&w.bind("smartresize.isotope",function(){i.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(a){var b=this.options.itemSelector,c=b?a.filter(b).add(a.find(b)):a,d={position:"absolute"};return c=c.filter(function(a,b){return 1===b.nodeType}),this.usingTransforms&&(d.left=0,d.top=0),c.css(d).addClass(this.options.itemClass),this.updateSortData(c,!0),c},_init:function(a){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(a)},option:function(a){if(b.isPlainObject(a)){this.options=b.extend(!0,this.options,a);var c;for(var d in a)c="_update"+g(d),this[c]&&this[c]()}},_updateAnimationEngine:function(){var a,b=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"");switch(b){case"css":case"none":a=!1;break;case"jquery":a=!0;break;default:a=!f.csstransitions}this.isUsingJQueryAnimation=a,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var a=this.usingTransforms=this.options.transformsEnabled&&f.csstransforms&&f.csstransitions&&!this.isUsingJQueryAnimation;a||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=a?this._translate:this._positionAbs},_filter:function(a){var b=""===this.options.filter?"*":this.options.filter;if(!b)return a;var c=this.options.hiddenClass,d="."+c,e=a.filter(d),f=e;if("*"!==b){f=e.filter(b);var g=a.not(d).not(b).addClass(c);this.styleQueue.push({$el:g,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:f,style:this.options.visibleStyle}),f.removeClass(c),a.filter(b)},updateSortData:function(a,c){var d,e,f=this,g=this.options.getSortData;a.each(function(){d=b(this),e={};for(var a in g)e[a]=c||"original-order"!==a?g[a](d,f):b.data(this,"isotope-sort-data")[a];b.data(this,"isotope-sort-data",e)})},_sort:function(){var a=this.options.sortBy,b=this._getSorter,c=this.options.sortAscending?1:-1,d=function(d,e){var f=b(d,a),g=b(e,a);return f===g&&"original-order"!==a&&(f=b(d,"original-order"),g=b(e,"original-order")),(f>g?1:g>f?-1:0)*c};this.$filteredAtoms.sort(d)},_getSorter:function(a,c){return b.data(a,"isotope-sort-data")[c]},_translate:function(a,b){return{translate:[a,b]}},_positionAbs:function(a,b){return{left:a,top:b}},_pushPosition:function(a,b,c){b=Math.round(b+this.offset.left),c=Math.round(c+this.offset.top);var d=this.getPositionStyles(b,c);this.styleQueue.push({$el:a,style:d}),this.options.itemPositionDataEnabled&&a.data("isotope-item-position",{x:b,y:c})},layout:function(a,b){var c=this.options.layoutMode;if(this["_"+c+"Layout"](a),this.options.resizesContainer){var d=this["_"+c+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:d})}this._processStyleQueue(a,b),this.isLaidOut=!0},_processStyleQueue:function(a,c){var d,e,g,h,i=this.isLaidOut&&this.isUsingJQueryAnimation?"animate":"css",j=this.options.animationOptions,k=this.options.onLayout;if(e=function(a,b){b.$el[i](b.style,j)},this._isInserting&&this.isUsingJQueryAnimation)e=function(a,b){d=b.$el.hasClass("no-transition")?"css":i,b.$el[d](b.style,j)};else if(c||k||j.complete){var l=!1,m=[c,k,j.complete],n=this;if(g=!0,h=function(){if(!l){for(var b,c=0,d=m.length;d>c;c++)b=m[c],"function"==typeof b&&b.call(n.element,a,n);l=!0}},this.isUsingJQueryAnimation&&"animate"===i)j.complete=h,g=!1;else if(f.csstransitions){for(var o,p=0,s=this.styleQueue[0],t=s&&s.$el;!t||!t.length;){if(o=this.styleQueue[p++],!o)return;t=o.$el}var u=parseFloat(getComputedStyle(t[0])[r]);u>0&&(e=function(a,b){b.$el[i](b.style,j).one(q,h)},g=!1)}}b.each(this.styleQueue,e),g&&h(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(a){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,a)},addItems:function(a,b){var c=this._getAtoms(a);this.$allAtoms=this.$allAtoms.add(c),b&&b(c)},insert:function(a,b){this.element.append(a);var c=this;this.addItems(a,function(a){var d=c._filter(a);c._addHideAppended(d),c._sort(),c.reLayout(),c._revealAppended(d,b)})},appended:function(a,b){var c=this;this.addItems(a,function(a){c._addHideAppended(a),c.layout(a),c._revealAppended(a,b)})},_addHideAppended:function(a){this.$filteredAtoms=this.$filteredAtoms.add(a),a.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:a,style:this.options.hiddenStyle})},_revealAppended:function(a,b){var c=this;setTimeout(function(){a.removeClass("no-transition"),c.styleQueue.push({$el:a,style:c.options.visibleStyle}),c._isInserting=!1,c._processStyleQueue(a,b)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(a,b){this.$allAtoms=this.$allAtoms.not(a),this.$filteredAtoms=this.$filteredAtoms.not(a);var c=this,d=function(){a.remove(),b&&b.call(c.element)};a.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:a,style:this.options.hiddenStyle}),this._sort(),this.reLayout(d)):d()},shuffle:function(a){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(a)},destroy:function(){var a=this.usingTransforms,b=this.options;this.$allAtoms.removeClass(b.hiddenClass+" "+b.itemClass).each(function(){var b=this.style;b.position="",b.top="",b.left="",b.opacity="",a&&(b[j]="")});var c=this.element[0].style;for(var d in this.originalStyle)c[d]=this.originalStyle[d];this.element.unbind(".isotope").undelegate("."+b.hiddenClass,"click").removeClass(b.containerClass).removeData("isotope"),w.unbind(".isotope")},_getSegments:function(a){var b,c=this.options.layoutMode,d=a?"rowHeight":"columnWidth",e=a?"height":"width",f=a?"rows":"cols",h=this.element[e](),i=this.options[c]&&this.options[c][d]||this.$filteredAtoms["outer"+g(e)](!0)||h;b=Math.floor(h/i),b=Math.max(b,1),this[c][f]=b,this[c][d]=i},_checkIfSegmentsChanged:function(a){var b=this.options.layoutMode,c=a?"rows":"cols",d=this[b][c];return this._getSegments(a),this[b][c]!==d},_masonryReset:function(){this.masonry={},this._getSegments();var a=this.masonry.cols;for(this.masonry.colYs=[];a--;)this.masonry.colYs.push(0)},_masonryLayout:function(a){var c=this,d=c.masonry;a.each(function(){var a=b(this),e=Math.ceil(a.outerWidth(!0)/d.columnWidth);if(e=Math.min(e,d.cols),1===e)c._masonryPlaceBrick(a,d.colYs);else{var f,g,h=d.cols+1-e,i=[];for(g=0;h>g;g++)f=d.colYs.slice(g,g+e),i[g]=Math.max.apply(Math,f);c._masonryPlaceBrick(a,i)}})},_masonryPlaceBrick:function(a,b){for(var c=Math.min.apply(Math,b),d=0,e=0,f=b.length;f>e;e++)if(b[e]===c){d=e;break}var g=this.masonry.columnWidth*d,h=c;this._pushPosition(a,g,h);var i=c+a.outerHeight(!0),j=this.masonry.cols+1-f;for(e=0;j>e;e++)this.masonry.colYs[d+e]=i},_masonryGetContainerSize:function(){var a=Math.max.apply(Math,this.masonry.colYs);return{height:a}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(a){var c=this,d=this.element.width(),e=this.fitRows;a.each(function(){var a=b(this),f=a.outerWidth(!0),g=a.outerHeight(!0);0!==e.x&&f+e.x>d&&(e.x=0,e.y=e.height),c._pushPosition(a,e.x,e.y),e.height=Math.max(e.y+g,e.height),e.x+=f})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(a){var c=this,d=this.cellsByRow;a.each(function(){var a=b(this),e=d.index%d.cols,f=Math.floor(d.index/d.cols),g=(e+.5)*d.columnWidth-a.outerWidth(!0)/2,h=(f+.5)*d.rowHeight-a.outerHeight(!0)/2;c._pushPosition(a,g,h),d.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(a){var c=this;a.each(function(){var a=b(this);c._pushPosition(a,0,c.straightDown.y),c.straightDown.y+=a.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var a=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];a--;)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(a){var c=this,d=c.masonryHorizontal;a.each(function(){var a=b(this),e=Math.ceil(a.outerHeight(!0)/d.rowHeight);if(e=Math.min(e,d.rows),1===e)c._masonryHorizontalPlaceBrick(a,d.rowXs);else{var f,g,h=d.rows+1-e,i=[];for(g=0;h>g;g++)f=d.rowXs.slice(g,g+e),i[g]=Math.max.apply(Math,f);c._masonryHorizontalPlaceBrick(a,i)}})},_masonryHorizontalPlaceBrick:function(a,b){for(var c=Math.min.apply(Math,b),d=0,e=0,f=b.length;f>e;e++)if(b[e]===c){d=e;break}var g=c,h=this.masonryHorizontal.rowHeight*d;this._pushPosition(a,g,h);var i=c+a.outerWidth(!0),j=this.masonryHorizontal.rows+1-f;for(e=0;j>e;e++)this.masonryHorizontal.rowXs[d+e]=i},_masonryHorizontalGetContainerSize:function(){var a=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:a}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(a){var c=this,d=this.element.height(),e=this.fitColumns;a.each(function(){var a=b(this),f=a.outerWidth(!0),g=a.outerHeight(!0);0!==e.y&&g+e.y>d&&(e.x=e.width,e.y=0),c._pushPosition(a,e.x,e.y),e.width=Math.max(e.x+f,e.width),e.y+=g})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function(a){var c=this,d=this.cellsByColumn;a.each(function(){var a=b(this),e=Math.floor(d.index/d.rows),f=d.index%d.rows,g=(e+.5)*d.columnWidth-a.outerWidth(!0)/2,h=(f+.5)*d.rowHeight-a.outerHeight(!0)/2;c._pushPosition(a,g,h),d.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(a){var c=this;a.each(function(){var a=b(this);c._pushPosition(a,c.straightAcross.x,0),c.straightAcross.x+=a.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},b.fn.imagesLoaded=function(a){function c(){a.call(e,f)}function d(a){var e=a.target;e.src!==h&&-1===b.inArray(e,i)&&(i.push(e),--g<=0&&(setTimeout(c),f.unbind(".imagesLoaded",d)))}var e=this,f=e.find("img").add(e.filter("img")),g=f.length,h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i=[];return g||c(),f.bind("load.imagesLoaded error.imagesLoaded",d).each(function(){var a=this.src;this.src=h,this.src=a}),e};var x=function(b){a.console&&a.console.error(b)};b.fn.isotope=function(a,c){if("string"==typeof a){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var c=b.data(this,"isotope");return c?b.isFunction(c[a])&&"_"!==a.charAt(0)?void c[a].apply(c,d):void x("no such method '"+a+"' for isotope instance"):void x("cannot call methods on isotope prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){var d=b.data(this,"isotope");d?(d.option(a),d._init(c)):b.data(this,"isotope",new b.Isotope(a,this,c))});return this}}(window,jQuery),function(a){a.fn.superfish=function(b){var c=a.fn.superfish,d=c.c,e=a('<span class="'+d.arrowClass+' arrow_down"> &#x25BC;</span>'),f=function(){var b=a(this),c=j(b);clearTimeout(c.sfTimer),b.showSuperfishUl().siblings().hideSuperfishUl()},g=function(b){var d=a(this),e=j(d);"click"===b.type||c.ios?a.proxy(h,d,e)():(clearTimeout(e.sfTimer),e.sfTimer=setTimeout(a.proxy(h,d,e),e.delay))},h=function(b){b.retainPath=a.inArray(this[0],b.$path)>-1,this.hideSuperfishUl(),this.parents("."+b.hoverClass).length||(b.onIdle.call(i(this)),b.$path.length&&a.proxy(f,b.$path)())},i=function(a){return a.closest("."+d.menuClass)},j=function(a){return i(a).data("sf-options")},k=function(a){a.css("ms-touch-action","none")},l=function(b,d){var e="li:has(ul)";d.useClick||(a.fn.hoverIntent&&!d.disableHI?b.hoverIntent(f,g,e):b.on("mouseenter",e,f).on("mouseleave",e,g));var h="MSPointerDown";c.ios||(h+=" touchstart"),c.wp7&&(h+=" mousedown"),b.on("focusin","li",f).on("focusout","li",g).on("click","a",d,n).on(h,"a",m)},m=function(b){var c=a(this),d=c.siblings("ul");return d.length>0&&d.is(":hidden")&&(c.data("follow",!1),"MSPointerDown"===b.type)?(c.trigger("focus"),!1):void 0},n=function(b){var c=a(this),d=b.data,e=c.siblings("ul"),h=c.data("follow")===!1?!1:!0;!e.length||!d.useClick&&h||(b.preventDefaolt(),e.is(":hidden")?a.proxy(f,c.parent("li"))():d.useClick&&h&&a.proxy(g,c.parent("li"),b)())},o=function(b,c){return b.find("li."+c.pathClass).slice(0,c.pathLevels).addClass(c.hoverClass+" "+d.bcClass).filter(function(){return a(this).children("ul").hide().show().length}).removeClass(c.pathClass)},p=function(b,c){c.autoArrows&&b.children("a").each(function(){q(a(this))})},q=function(a){a.addClass(d.anchorClass).append(e.clone())};return c.getOptions=j,this.addClass(d.menuClass).each(function(){var e=a(this),f=a.extend({},c.defaults,b),g=e.find("li:has(ul)");f.$path=o(e,f),e.data("sf-options",f),p(g,f),k(e),l(e,f),g.not("."+d.bcClass).hideSuperfishUl(!0),f.onInit.call(this)})};var b=a.fn.superfish;b.o=[],b.op={},b.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator"},b.defaults={hoverClass:"sfHover",appendTo:null,pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",autoArrows:!0,disableHI:!1,useClick:!1,onInit:a.noop,onBeforeShow:a.noop,onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop},b.ios=/iPhone|iPad|iPod/i.test(navigator.userAgent),b.wp7=function(){var a=document.documentElement.style;return"behavior"in a&&"fill"in a&&/iemobile/i.test(navigator.userAgent)}(),a.fn.extend({hideSuperfishUl:function(c){if(this.length){var d=this,e=b.getOptions(d),f=e.retainPath===!0?e.$path:"",g=d.find("li."+e.hoverClass).add(this).not(f).removeClass(e.hoverClass).children("ul"),h=e.speedOut;c&&(g.show(),h=0),e.retainPath=!1,e.onBeforeHide.call(g),g.stop(!0,!0).animate(e.animationOut,h,function(){var b=a(this);e.onHide.call(b),e.useClick&&b.siblings("a").data("follow",!1)})}return this},showSuperfishUl:function(){var a=b.getOptions(this),c=this.addClass(a.hoverClass),d=c.children("ul");return a.onBeforeShow.call(d),d.stop(!0,!0).animate(a.animation,a.speed,function(){a.onShow.call(d),c.children("a").data("follow",!0)}),this}}),b.ios&&a(window).load(function(){a("body").children().on("click",a.noop)})}($j),function(a){a.fn.subnav=function(){var b=function(b){var d=a(b).css("color"),e="#"===d[0]?c(d):d.replace("rgb(","").replace(")","").replace(/\s+/g,"").split(",");return.2126*e[0]/255+.7152*e[1]/255+.0722*e[2]/255},c=function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,c=null;return a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d}),c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a),c?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:null};this.superfish(),this.each(function(){var c=a(this).addClass("sf-menu"),d=a("> li",this),e=a("> li > ul",this),f=0,g=[],h=a(d[0]),i=a(d[1]),j=i.length&&Math.abs(h.offset().top-i.offset().top)>h.height()/2,k=0,l=j?"width":"height",m=j?"left":"top";if(0!==d.length){if(d.each(function(c,d){var e=a(d);"inline"===e.css("display")&&e.css("display","inline-block"),g=a(this).find("a"),g.length>0&&(f+=b(g))}),f/=d.length,a("ul",c).addClass(f>.6?"sf-dark":"sf-light"),j){c.addClass("sf-vertical");var n=a(window).width()/2;c.offset().left>n&&c.addClass("sf-right")}e.each(function(){k=a(this)[l]()>k?a(this)[l]():k}),k+=c[l](),c.parents().add(c).each(function(b,d){var e=a(d),f=e[l]()+e.offset()[m],g=c.offset()[m]+k;"hidden"==e.css("overflow")&&g>f&&e.css("overflow","visible").addClass("aclearfix")})}})}}($j);